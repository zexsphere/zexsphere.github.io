<!doctype html><html lang=en><head><meta charset=utf-8><meta name=referrer content="same-origin"><title>TCP/IP stack in network programming :: Zex</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="tcp/ip stack intro +-------+ +-------+ +-------+ | ping | |telnet | | DNS | +---+---+ +---+---+ +---+---+ | | | +----------------------------------------------------------------------+ socket | | | | +---+---+ +---+---+ | | TCP +-------------+-----------+ UDP | | +-------+ | +-------+ | | +----------------------------------------------------------------------+ | | +---+---+ | | ICMP +--------------------------------------+ +-------+ | +---+---+ | IP | +---+---+ | +----------------------------------------------------------------------+ | +-------+ | | ARP +---------------+ +-------+ | +---+---+ | Frame | +-------+ arp ARP &amp;lt;net/if_arp."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/post/0010/><link rel=stylesheet href=/assets/style.min.css?d41d8cd98f00b204e9800998ecf8427e><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/favicon/apple-icon-precomposed.png><link rel="shortcut icon" href=/img/favicon/orange.png><meta name=twitter:card content="summary"><meta property="og:type" content="article"><meta property="og:title" content="TCP/IP stack in network programming :: Zex"><meta property="og:description" content="The realm of network programming involves various concepts, which often overwhelm beginners. However, these concepts are foundational and essential. Unfortunately, in practical work, we often encounter them in isolated and fragmented ways, without a clear and gradual learning path. This can be quite disheartening."><meta property="og:url" content="/post/0010/"><meta property="og:site_name" content="Zex"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2023-09-20 15:51:45 +0800 +0800"></head><body><div class="container center headings--one-size"><header class=header style=background-image:url(/img/mountain/mountains-g47d3aaa15_1280.jpg);background-position:50%;background-repeat:no-repeat;background-size:cover><div class=header__inner><div class=header__logo><a href=/><div class=logo>Zex</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/archive>Archive</a></li><li><a href=/explore>Explore</a></li><li><a href=/notes>Notes</a></li><li><a href=/exhibits>Exhibits</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/archive>Archive</a></li><li><a href=/explore>Explore</a></li><li><a href=/notes>Notes</a></li><li><a href=/exhibits>Exhibits</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title>TCP/IP stack in network programming</h1><div class=post-meta><span class=post-date>2023-09-20</span>
<span class=post-author>::
zexsphere</span></div><div class=post-content><div><h2 id=tcpip-stack-intro>tcp/ip stack intro<a href=#tcpip-stack-intro class=hanchor arialabel=Anchor>⚓</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=o>+-------+</span><span class=w>                </span><span class=o>+-------+</span><span class=w>                         </span><span class=o>+-------+</span>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=vg>ping</span><span class=w>  </span><span class=o>|</span><span class=w>                </span><span class=o>|</span><span class=vg>telnet</span><span class=w> </span><span class=o>|</span><span class=w>                         </span><span class=o>|</span><span class=w>  </span><span class=vg>DNS</span><span class=w>  </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=o>+---+---+</span><span class=w>                </span><span class=o>+---+---+</span><span class=w>                         </span><span class=o>+---+---+</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                        </span><span class=o>|</span><span class=w>                                 </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+----------------------------------------------------------------------+</span><span class=w>  </span><span class=vg>socket</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                        </span><span class=o>|</span><span class=w>                                 </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                    </span><span class=o>+---+---+</span><span class=w>                         </span><span class=o>+---+---+</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                    </span><span class=o>|</span><span class=w>  </span><span class=vg>TCP</span><span class=w>  </span><span class=o>+-------------+-----------+</span><span class=w>  </span><span class=vg>UDP</span><span class=w>  </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                    </span><span class=o>+-------+</span><span class=w>             </span><span class=o>|</span><span class=w>           </span><span class=o>+-------+</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                                          </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+----------------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                                          </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=o>+---+---+</span><span class=w>                                      </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w>  </span><span class=o>+--------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=o>+-------+</span><span class=w>                                      </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=o>+---+---+</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=o>|</span><span class=w>  </span><span class=vg>IP</span><span class=w>   </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=o>+---+---+</span>
</span></span><span class=line><span class=cl><span class=w>                                                 </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+----------------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=w>                                                 </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                         </span><span class=o>+-------+</span><span class=w>               </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                         </span><span class=o>|</span><span class=w>  </span><span class=vg>ARP</span><span class=w>  </span><span class=o>+---------------+</span>
</span></span><span class=line><span class=cl><span class=w>                         </span><span class=o>+-------+</span><span class=w>               </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=o>+---+---+</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=o>|</span><span class=w> </span><span class=vg>Frame</span><span class=w> </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=o>+-------+</span>
</span></span></code></pre></div><h3 id=arp>arp<a href=#arp class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>ARP</span><span class=w>                                            </span><span class=o>&lt;</span><span class=vg>net</span><span class=o>/</span><span class=vg>if_arp</span><span class=o>.</span><span class=vg>h</span><span class=o>&gt;</span><span class=w> </span><span class=vg>struct</span><span class=w> </span><span class=vg>arphdr</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>+----------------------+</span><span class=w>  </span><span class=vg>ar_hdr</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>format</span><span class=w> </span><span class=vg>of</span><span class=w>  </span><span class=vg>hardware</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>|</span><span class=w>    </span><span class=o>+-----------------|</span><span class=w>  </span><span class=vg>ar_pro</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>format</span><span class=w> </span><span class=vg>of</span><span class=w>  </span><span class=vg>protocol</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>+------------|</span><span class=w>  </span><span class=vg>ar_hln</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=vg>of</span><span class=w>  </span><span class=vg>hardware</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>+---------|</span><span class=w>  </span><span class=vg>ar_pln</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=vg>of</span><span class=w>  </span><span class=vg>protocol</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=o>+------+</span><span class=w>  </span><span class=vg>ar_op</span><span class=w>   </span><span class=o>/*</span><span class=w> </span><span class=vg>ARP</span><span class=w> </span><span class=vg>opcode</span><span class=w> </span><span class=p>(</span><span class=vg>command</span><span class=p>)</span><span class=w>        </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>+----------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=w>              </span><span class=p>(</span><span class=vg>byte</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=il>2</span><span class=w>   </span><span class=o>|</span><span class=il>2</span><span class=w>   </span><span class=o>|</span><span class=il>1</span><span class=w> </span><span class=o>|</span><span class=il>1</span><span class=w> </span><span class=o>|</span><span class=il>2</span><span class=w>   </span><span class=o>|</span><span class=il>6</span><span class=w>           </span><span class=o>|</span><span class=il>4</span><span class=w>       </span><span class=o>|</span><span class=il>6</span><span class=w>           </span><span class=o>|</span><span class=il>4</span><span class=w>       </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>+----------------------------------------------------------------+</span>
</span></span><span class=line><span class=cl><span class=w>                                          </span><span class=o>|</span><span class=w>            </span><span class=o>|</span><span class=w>        </span><span class=o>|</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=vg>netinet</span><span class=o>/</span><span class=vg>if_ether</span><span class=o>.</span><span class=vg>h</span><span class=o>&gt;</span><span class=w> </span><span class=vg>struct</span><span class=w> </span><span class=vg>ether_arp</span><span class=w>     </span><span class=o>|</span><span class=w>            </span><span class=o>|</span><span class=w>        </span><span class=o>|</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=vg>arp_sha</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>sender</span><span class=w> </span><span class=vg>hardware</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span><span class=w>  </span><span class=o>+-+</span><span class=w>            </span><span class=o>|</span><span class=w>        </span><span class=o>|</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=vg>arp_spa</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>sender</span><span class=w> </span><span class=vg>protocol</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span><span class=w>  </span><span class=o>|--------------+</span><span class=w>        </span><span class=o>|</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=vg>arp_tha</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>target</span><span class=w> </span><span class=vg>hardware</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span><span class=w>  </span><span class=o>|-----------------------+</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=vg>arp_tpa</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>target</span><span class=w> </span><span class=vg>protocol</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span><span class=w>  </span><span class=o>+------------------------------------+</span>
</span></span></code></pre></div><h3 id=ip>ip<a href=#ip class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>IP</span>
</span></span><span class=line><span class=cl><span class=w>                        </span><span class=il>1</span><span class=w>                            </span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=vg>bit</span><span class=p>)</span><span class=w>  </span><span class=il>0</span><span class=w>  </span><span class=il>3</span><span class=w> </span><span class=il>4</span><span class=w>  </span><span class=il>7</span><span class=w> </span><span class=il>8</span><span class=w>      </span><span class=il>5</span><span class=w>            </span><span class=il>0</span><span class=w>      </span><span class=il>7</span><span class=w> </span><span class=il>8</span><span class=w>      </span><span class=il>5</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>+----+----+--------+</span><span class=w>          </span><span class=o>+-----------------+</span><span class=w>    </span><span class=o>&lt;</span><span class=vg>netinet</span><span class=o>/</span><span class=vg>ip</span><span class=o>.</span><span class=vg>h</span><span class=o>&gt;</span><span class=w> </span><span class=vg>struct</span><span class=w> </span><span class=vg>ip</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=vg>V</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=vg>hl</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=vg>tos</span><span class=w>    </span><span class=o>|</span><span class=w>   </span><span class=o>-----&gt;</span><span class=w> </span><span class=o>|</span><span class=vg>ttl</span><span class=w>     </span><span class=o>|</span><span class=vg>p</span><span class=w>       </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>+----+----+--------+</span><span class=w>  </span><span class=o>/</span><span class=w>       </span><span class=o>+-----------------+</span><span class=w>    </span><span class=vg>ip_v</span><span class=w>    </span><span class=o>/*</span><span class=w> </span><span class=vg>version</span><span class=w>               </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>^</span><span class=w>                    </span><span class=o>/</span><span class=w>                               </span><span class=vg>ip_hl</span><span class=w>   </span><span class=o>/*</span><span class=w> </span><span class=vg>header</span><span class=w> </span><span class=vg>length</span><span class=w>         </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>                   </span><span class=o>|</span><span class=w>                                </span><span class=vg>ip_tos</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>type</span><span class=w> </span><span class=vg>of</span><span class=w> </span><span class=vg>service</span><span class=w>       </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>+--------------+--------------------------------+</span><span class=w>    </span><span class=vg>ip_len</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>total</span><span class=w> </span><span class=vg>length</span><span class=w>          </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=vg>len</span><span class=w> </span><span class=o>|</span><span class=vg>id</span><span class=w>  </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=vg>sum</span><span class=w> </span><span class=o>|</span><span class=vg>src</span><span class=w>     </span><span class=o>|</span><span class=vg>dst</span><span class=w>     </span><span class=o>|</span><span class=w>    </span><span class=vg>ip_id</span><span class=w>   </span><span class=o>/*</span><span class=w> </span><span class=vg>identification</span><span class=w>        </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>+-------------------+---------------------------+</span><span class=w>    </span><span class=vg>ip_off</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>fragment</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=vg>field</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=vg>byte</span><span class=p>)</span><span class=w> </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>   </span><span class=o>|</span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>4</span><span class=w>        </span><span class=il>4</span><span class=w>            </span><span class=vg>ip_ttl</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>time</span><span class=w> </span><span class=vg>to</span><span class=w> </span><span class=vg>live</span><span class=w>          </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=vg>v</span><span class=w>                                     </span><span class=vg>ip_p</span><span class=w>    </span><span class=o>/*</span><span class=w> </span><span class=vg>protocol</span><span class=w>              </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>+-----------------+</span><span class=w>                   </span><span class=vg>ip_sum</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>checksum</span><span class=w>              </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>|</span><span class=vg>id</span><span class=w> </span><span class=o>|</span><span class=vg>off</span><span class=w>          </span><span class=o>|</span><span class=w>                   </span><span class=vg>ip_src</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>source</span><span class=w> </span><span class=vg>address</span><span class=w>        </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                     </span><span class=o>+-----------------+</span><span class=w>                   </span><span class=vg>ip_dst</span><span class=w>  </span><span class=o>/*</span><span class=w> </span><span class=vg>dest</span><span class=w> </span><span class=vg>address</span><span class=w>          </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=il>0</span><span class=w> </span><span class=il>2</span><span class=w> </span><span class=il>3</span><span class=w>           </span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=w>                                      </span><span class=il>5</span>
</span></span></code></pre></div><h3 id=icmp>icmp<a href=#icmp class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>ICMP</span><span class=w>                                       </span><span class=o>&lt;</span><span class=vg>netinet</span><span class=o>/</span><span class=vg>ip_icmp</span><span class=o>.</span><span class=vg>h</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>+---------------------------------------&gt;</span><span class=w>  </span><span class=vg>type</span><span class=w>         </span><span class=o>/*</span><span class=w> </span><span class=vg>message</span><span class=w> </span><span class=vg>type</span><span class=w>  </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w>  </span><span class=o>+------------------------------------&gt;</span><span class=w>  </span><span class=vg>code</span><span class=w>         </span><span class=o>/*</span><span class=w> </span><span class=vg>type</span><span class=w> </span><span class=vg>sub</span><span class=o>-</span><span class=vg>code</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=o>+---------------------------------&gt;</span><span class=w>  </span><span class=vg>checksum</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+-----------+---------------------------+</span><span class=w>  </span><span class=vg>union</span><span class=w> </span><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=il>1</span><span class=w> </span><span class=o>|</span><span class=il>1</span><span class=w> </span><span class=o>|</span><span class=il>2</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=il>4</span><span class=w> </span><span class=p>(</span><span class=vg>variable</span><span class=p>)</span><span class=w>              </span><span class=o>|</span><span class=w>    </span><span class=vg>struct</span><span class=w> </span><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=o>+-----------+---------------------------+</span><span class=w>      </span><span class=vg>id</span>
</span></span><span class=line><span class=cl><span class=w>                                               </span><span class=vg>sequence</span>
</span></span><span class=line><span class=cl><span class=w> </span><span class=vg>ICMP_ECHO</span><span class=w>      </span><span class=il>8</span><span class=w>  </span><span class=o>&lt;--------------------+</span><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=vg>echo</span><span class=w>     </span><span class=o>/*</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>datagram</span><span class=w>   </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w> </span><span class=vg>ICMP_ECHOREPLY</span><span class=w> </span><span class=il>0</span><span class=w>           </span><span class=vg>type</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=vg>gateway</span><span class=w>    </span><span class=o>/*</span><span class=w> </span><span class=vg>gateway</span><span class=w> </span><span class=vg>address</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=vg>struct</span><span class=w> </span><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=w>                                               </span><span class=vg>reserved</span>
</span></span><span class=line><span class=cl><span class=w>                                               </span><span class=vg>mtu</span>
</span></span><span class=line><span class=cl><span class=w>                                             </span><span class=p>}</span><span class=w> </span><span class=vg>frag</span><span class=w>     </span><span class=o>/*</span><span class=w> </span><span class=vg>path</span><span class=w> </span><span class=vg>mtu</span><span class=w> </span><span class=vg>discovery</span><span class=w> </span><span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=w>                                           </span><span class=p>}</span>
</span></span></code></pre></div><h3 id=tcp>tcp<a href=#tcp class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>TCP</span><span class=w>                           </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w>            </span><span class=o>&lt;</span><span class=vg>netinet</span><span class=o>/</span><span class=vg>tcp</span><span class=o>.</span><span class=vg>h</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=vg>bit</span><span class=p>)</span><span class=w>   </span><span class=il>0</span><span class=w>  </span><span class=il>3</span><span class=w> </span><span class=il>4</span><span class=w>  </span><span class=il>7</span><span class=w> </span><span class=il>8</span><span class=w> </span><span class=il>9</span><span class=w> </span><span class=il>0</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>2</span><span class=w> </span><span class=il>3</span><span class=w> </span><span class=il>4</span><span class=w> </span><span class=il>5</span>
</span></span><span class=line><span class=cl><span class=w>               </span><span class=o>+-----------+-+-+-+-+-+-+-+</span><span class=w>           </span><span class=vg>sport</span><span class=w>    </span><span class=vg>off</span><span class=w>  </span><span class=o>:</span><span class=il>4</span><span class=w>    </span><span class=vg>win</span>
</span></span><span class=line><span class=cl><span class=w>               </span><span class=o>|</span><span class=vg>off</span><span class=w> </span><span class=o>|</span><span class=vg>res1</span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=vg>dport</span><span class=w>    </span><span class=vg>res1</span><span class=w> </span><span class=o>:</span><span class=il>4</span><span class=w>    </span><span class=vg>sum</span>
</span></span><span class=line><span class=cl><span class=w>               </span><span class=o>+-----------+-+-+-+-+-+-+-+</span><span class=w>           </span><span class=vg>seq</span><span class=w>      </span><span class=vg>CWR</span><span class=w>  </span><span class=o>:</span><span class=il>1</span><span class=w>    </span><span class=vg>urp</span>
</span></span><span class=line><span class=cl><span class=w>                                         </span><span class=o>^</span><span class=w>           </span><span class=vg>ack</span><span class=w>      </span><span class=vg>ECE</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=w>                                         </span><span class=o>|</span><span class=w>                    </span><span class=vg>URG</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>+---------------------------+--+------------------+</span><span class=w>    </span><span class=vg>ACK</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>|</span><span class=vg>sp</span><span class=w>  </span><span class=o>|</span><span class=vg>dp</span><span class=w>  </span><span class=o>|</span><span class=vg>seq</span><span class=w>     </span><span class=o>|</span><span class=vg>ack</span><span class=w>     </span><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=o>|</span><span class=vg>win</span><span class=w> </span><span class=o>|</span><span class=vg>sum</span><span class=w> </span><span class=o>|</span><span class=vg>urp</span><span class=w>  </span><span class=o>|</span><span class=w>    </span><span class=vg>PSH</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>+---------------------------+--+------------------+</span><span class=w>    </span><span class=vg>RST</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=vg>byte</span><span class=p>)</span><span class=w>  </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>4</span><span class=w>        </span><span class=il>4</span><span class=w>        </span><span class=il>1</span><span class=w>  </span><span class=il>1</span><span class=w>  </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>         </span><span class=vg>SYN</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span><span class=line><span class=cl><span class=w>                                                              </span><span class=vg>FIN</span><span class=w>  </span><span class=o>:</span><span class=il>1</span>
</span></span></code></pre></div><h3 id=udp>udp<a href=#udp class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=vg>UDP</span><span class=w>                               </span><span class=o>&lt;</span><span class=vg>netinet</span><span class=o>/</span><span class=vg>udp</span><span class=o>.</span><span class=vg>h</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>+------------------+</span><span class=w>       </span><span class=vg>sport</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>|</span><span class=vg>sp</span><span class=w>  </span><span class=o>|</span><span class=vg>dp</span><span class=w>  </span><span class=o>|</span><span class=vg>ulen</span><span class=o>|</span><span class=vg>sum</span><span class=o>|</span><span class=w>       </span><span class=vg>dport</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>+------------------+</span><span class=w>       </span><span class=vg>ulen</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=vg>byte</span><span class=p>)</span><span class=w>  </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>          </span><span class=vg>sum</span>
</span></span></code></pre></div><h3 id=dns>dns<a href=#dns class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>DNS</span><span class=w>                                         </span><span class=vg>Response</span><span class=w>      </span><span class=o>+---------+</span>
</span></span><span class=line><span class=cl><span class=w>                                            </span><span class=vg>Opcode</span><span class=w>                  </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                                            </span><span class=vg>Authoritative</span><span class=w>           </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                                         </span><span class=il>6</span><span class=w>  </span><span class=vg>Truncated</span><span class=w>               </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                              </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>1</span><span class=w>  </span><span class=il>1</span><span class=w>   </span><span class=il>7</span><span class=w>  </span><span class=vg>Recursion</span><span class=w> </span><span class=vg>desired</span><span class=w>       </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=p>(</span><span class=vg>bit</span><span class=p>)</span><span class=w>  </span><span class=il>0</span><span class=w> </span><span class=il>1</span><span class=w>  </span><span class=il>4</span><span class=w> </span><span class=il>5</span><span class=w> </span><span class=il>6</span><span class=w> </span><span class=il>7</span><span class=w> </span><span class=il>8</span><span class=w> </span><span class=il>9</span><span class=w> </span><span class=il>0</span><span class=w> </span><span class=il>1</span><span class=w> </span><span class=il>2</span><span class=w>  </span><span class=il>5</span><span class=w>      </span><span class=vg>Recursion</span><span class=w> </span><span class=vg>available</span><span class=w>     </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>            </span><span class=o>+-+----+-+-+-+-+-+-+-+----+</span><span class=w>     </span><span class=vg>Z</span><span class=w>                       </span><span class=o>|</span><span class=w>     </span><span class=vg>transaction</span><span class=w> </span><span class=vg>id</span>
</span></span><span class=line><span class=cl><span class=w>            </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>     </span><span class=vg>Answer</span><span class=w> </span><span class=vg>anthenticated</span><span class=w>    </span><span class=o>+---+</span><span class=w> </span><span class=vg>flags</span>
</span></span><span class=line><span class=cl><span class=w>            </span><span class=o>+-+----+-+-+-+-+-+-+-+----+</span><span class=w>     </span><span class=vg>Non</span><span class=o>-</span><span class=vg>authenticated</span><span class=w> </span><span class=vg>data</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=vg>quentions</span>
</span></span><span class=line><span class=cl><span class=w>            </span><span class=o>^</span><span class=w>                               </span><span class=vg>Reply</span><span class=w> </span><span class=vg>code</span><span class=w>    </span><span class=o>+---------+</span><span class=w>     </span><span class=vg>answer</span><span class=w> </span><span class=vg>RRs</span>
</span></span><span class=line><span class=cl><span class=w>            </span><span class=o>|</span><span class=w>                                                             </span><span class=vg>authority</span><span class=w> </span><span class=vg>RRs</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>+---------+----+----+----+----+----+-----+</span><span class=w>                         </span><span class=vg>additional</span><span class=w> </span><span class=vg>RRs</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=vg>byte</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=o>||</span><span class=w>                         </span><span class=vg>queries</span>
</span></span><span class=line><span class=cl><span class=w>       </span><span class=o>+----+----+----+----+----+----+----+-----+</span><span class=w>                         </span><span class=vg>ansers</span>
</span></span><span class=line><span class=cl><span class=w>        </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span><span class=w>    </span><span class=il>2</span>
</span></span></code></pre></div><h2 id=practice>practice<a href=#practice class=hanchor arialabel=Anchor>⚓</a></h2><p>network topology</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>+-------------------+</span><span class=w>                  </span><span class=o>+-------------------+</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w> </span><span class=vg>laptop</span><span class=w>            </span><span class=o>|</span><span class=w>                  </span><span class=o>|</span><span class=w> </span><span class=vg>pi</span><span class=w>                </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=w>      </span><span class=o>|</span><span class=w>                  </span><span class=o>|</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=w>       </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w> </span><span class=nl>a8:</span><span class=il>9</span><span class=nl>a:</span><span class=il>73</span><span class=o>:</span><span class=il>35</span><span class=o>:</span><span class=il>96</span><span class=o>:</span><span class=il>89</span><span class=w> </span><span class=o>|</span><span class=w>                  </span><span class=o>|</span><span class=w> </span><span class=nl>e4:</span><span class=il>5</span><span class=nl>f:</span><span class=il>36</span><span class=o>:</span><span class=il>68</span><span class=o>:</span><span class=nl>db:</span><span class=vg>bd</span><span class=w> </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=w> </span><span class=vg>manjaro</span><span class=w>           </span><span class=o>|</span><span class=w>                  </span><span class=o>|</span><span class=w> </span><span class=vg>raspberry</span><span class=w>         </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+--------+----------+</span><span class=w>                  </span><span class=o>+---------+---------+</span>
</span></span><span class=line><span class=cl><span class=w>  </span><span class=vg>wlp2s0</span><span class=w> </span><span class=o>|</span><span class=w>                                       </span><span class=o>|</span><span class=w>   </span><span class=vg>eth0</span>
</span></span><span class=line><span class=cl><span class=o>+--------+--------------------+------------------+---------+</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=vg>wlan0</span><span class=w>   </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                   </span><span class=o>+----------+----------+</span>
</span></span><span class=line><span class=cl><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=vg>Router</span><span class=w>              </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=mf>192.168.2.1</span><span class=w>         </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=il>90</span><span class=o>:</span><span class=nl>f7:f2:eb:bb:</span><span class=vg>d4</span><span class=w>   </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                   </span><span class=o>+----------+----------+</span>
</span></span><span class=line><span class=cl><span class=w>                              </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                              </span><span class=o>+</span>
</span></span></code></pre></div><h3 id=arp-1>arp<a href=#arp-1 class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sudo arp -d 192.168.2.2
</span></span><span class=line><span class=cl>$ sudo tcpdump -i wlp2s0 -ent <span class=s1>&#39;(dst 192.168.2.2 and src 192.168.2.10) or 
</span></span></span><span class=line><span class=cl><span class=s1>                               (dst 192.168.2.10 and src 192.168.2.2)&#39;</span> -w arp.pcap 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># another window</span>
</span></span><span class=line><span class=cl>$ telnet 192.168.2.2 <span class=nb>echo</span>
</span></span><span class=line><span class=cl>Trying 192.168.2.2...
</span></span><span class=line><span class=cl>Connected to 192.168.2.2.
</span></span><span class=line><span class=cl>Escape character is <span class=s1>&#39;^]&#39;</span>.
</span></span><span class=line><span class=cl>hello!
</span></span><span class=line><span class=cl>hello!
</span></span><span class=line><span class=cl>^<span class=o>]</span>
</span></span><span class=line><span class=cl>telnet&gt; quit
</span></span><span class=line><span class=cl>Connection closed.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=nl>a8:</span><span class=il>9</span><span class=nl>a:</span><span class=il>73</span><span class=o>:</span><span class=il>35</span><span class=o>:</span><span class=il>96</span><span class=o>:</span><span class=il>89</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=nl>ff:ff:ff:ff:ff:</span><span class=vg>ff</span><span class=p>,</span><span class=w> </span><span class=vg>ethertype</span><span class=w> </span><span class=vg>ARP</span><span class=w> </span><span class=p>(</span><span class=il>0</span><span class=vg>x0806</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>42</span><span class=o>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>Request</span><span class=w> </span><span class=vg>who</span><span class=o>-</span><span class=vg>has</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=vg>tell</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>28</span>
</span></span><span class=line><span class=cl><span class=nl>e4:</span><span class=il>5</span><span class=nl>f:</span><span class=il>36</span><span class=o>:</span><span class=il>68</span><span class=o>:</span><span class=nl>db:</span><span class=vg>bd</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=nl>a8:</span><span class=il>9</span><span class=nl>a:</span><span class=il>73</span><span class=o>:</span><span class=il>35</span><span class=o>:</span><span class=il>96</span><span class=o>:</span><span class=il>89</span><span class=p>,</span><span class=w> </span><span class=vg>ethertype</span><span class=w> </span><span class=vg>ARP</span><span class=w> </span><span class=p>(</span><span class=il>0</span><span class=vg>x0806</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>42</span><span class=o>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>Reply</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=vg>is</span><span class=o>-</span><span class=vg>at</span><span class=w> </span><span class=nl>e4:</span><span class=il>5</span><span class=nl>f:</span><span class=il>36</span><span class=o>:</span><span class=il>68</span><span class=o>:</span><span class=nl>db:</span><span class=vg>bd</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>28</span>
</span></span></code></pre></div><h3 id=dns-1>dns<a href=#dns-1 class=hanchor arialabel=Anchor>⚓</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ sudo tcpdump -i eth0 -nt -s <span class=m>500</span> port domain
</span></span><span class=line><span class=cl>IP 192.168.2.2.54537 &gt; 192.168.2.1.53: 40868+ A? www.baidu.com. <span class=o>(</span>31<span class=o>)</span>
</span></span><span class=line><span class=cl>IP 192.168.2.1.53 &gt; 192.168.2.2.54537: <span class=m>40868</span> 2/0/0 A 14.119.104.254, A 14.119.104.189 <span class=o>(</span>63<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># another window</span>
</span></span><span class=line><span class=cl>$ host -t A www.baidu.com
</span></span><span class=line><span class=cl>www.baidu.com has address 14.119.104.254
</span></span><span class=line><span class=cl>www.baidu.com has address 14.119.104.189
</span></span></code></pre></div><h3 id=icmp-1>icmp<a href=#icmp-1 class=hanchor arialabel=Anchor>⚓</a></h3><p>MTU:
The maximum transmission unit (MTU) of a frame.</p><p>IP Fragment:
If the IP layer has data to transmit and the length of the data is larger than the maximum transmission unit (MTU) of the link layer, then the IP layer needs to perform fragmentation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=nl>MTU:</span><span class=w>   </span><span class=il>20</span><span class=w>                    </span><span class=il>8</span><span class=w>              </span><span class=vg>1472</span><span class=w>                        </span><span class=o>=</span><span class=w> </span><span class=il>1500</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>+---------------------+-------------+---------------------------+</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=vg>IP</span><span class=w> </span><span class=vg>hdr</span><span class=w>              </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>hdr</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>data</span><span class=w>                 </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=o>+---------------------+-------------+---------------------------+</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=vg>if</span><span class=w> </span><span class=vg>data</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=il>1472</span><span class=w>  </span><span class=o>+------------+</span><span class=w>       </span><span class=o>+------------+</span><span class=w>       </span><span class=o>+------------+</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>|</span><span class=w> </span><span class=vg>IP</span><span class=w>    </span><span class=vg>hdr</span><span class=w>  </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=vg>IP</span><span class=w>    </span><span class=vg>hdr</span><span class=w>  </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=vg>IP</span><span class=w>    </span><span class=vg>hdr</span><span class=w>  </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>      </span><span class=vg>for</span><span class=w> </span><span class=nl>example:</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=p>(</span><span class=vg>set</span><span class=w>  </span><span class=vg>MF</span><span class=p>)</span><span class=w>  </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=p>(</span><span class=vg>set</span><span class=w> </span><span class=vg>offset</span><span class=p>)</span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=p>(</span><span class=vg>set</span><span class=w> </span><span class=vg>offset</span><span class=p>)</span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>+------------+</span><span class=w>       </span><span class=o>+------------+</span><span class=w>       </span><span class=o>+------------+</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w>  </span><span class=vg>hdr</span><span class=w>  </span><span class=o>|</span><span class=w>   </span><span class=o>+</span><span class=w>   </span><span class=o>|</span><span class=w>            </span><span class=o>|</span><span class=w>   </span><span class=o>+</span><span class=w>   </span><span class=o>|</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>+------------+</span><span class=w>       </span><span class=o>|</span><span class=w>            </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>            </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w>  </span><span class=vg>data</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w>  </span><span class=vg>data</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=vg>ICMP</span><span class=w>  </span><span class=vg>data</span><span class=w> </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>|</span><span class=w>   </span><span class=il>1472</span><span class=w>     </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>   </span><span class=il>1480</span><span class=w>     </span><span class=o>|</span><span class=w>       </span><span class=o>|</span><span class=w>     </span><span class=il>1</span><span class=w>      </span><span class=o>|</span>
</span></span><span class=line><span class=cl><span class=w>                      </span><span class=o>+------------+</span><span class=w>       </span><span class=o>+------------+</span><span class=w>       </span><span class=o>+------------+</span>
</span></span><span class=line><span class=cl><span class=w>                       </span><span class=il>1500</span><span class=w>                 </span><span class=il>1500</span><span class=w>                 </span><span class=il>21</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=vg>ping</span><span class=w> </span><span class=mf>192.168.2.2</span>
</span></span><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=vg>sudo</span><span class=w> </span><span class=vg>tcpdump</span><span class=w> </span><span class=o>-</span><span class=vg>i</span><span class=w> </span><span class=vg>wlp2s0</span><span class=w> </span><span class=o>-</span><span class=vg>ntv</span><span class=w> </span><span class=vg>icmp</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>13535</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=vg>DF</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>84</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.10</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=o>:</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>request</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>12</span><span class=p>,</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>1</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>64</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>11628</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=vg>none</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>84</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=o>:</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>reply</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>12</span><span class=p>,</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>1</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>64</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>13681</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=vg>DF</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>84</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.10</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=o>:</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>request</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>12</span><span class=p>,</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>2</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>64</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>11827</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=vg>none</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>84</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=o>:</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>reply</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>12</span><span class=p>,</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>2</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=vg>ping</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=o>-</span><span class=vg>s</span><span class=w> </span><span class=il>1473</span>
</span></span><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=vg>sudo</span><span class=w> </span><span class=vg>tcpdump</span><span class=w> </span><span class=o>-</span><span class=vg>i</span><span class=w> </span><span class=vg>wlp2s0</span><span class=w> </span><span class=o>-</span><span class=vg>ntv</span><span class=w> </span><span class=vg>icmp</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>21704</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=o>+</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>1500</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.10</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=o>:</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>request</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>13</span><span class=p>,</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>1</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>1480</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>21704</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>1480</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=vg>none</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>21</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.10</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=o>:</span><span class=w> </span><span class=vg>ip</span><span class=o>-</span><span class=vg>proto</span><span class=il>-1</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>25541</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=o>+</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>1500</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=o>:</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=vg>echo</span><span class=w> </span><span class=vg>reply</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>13</span><span class=p>,</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>1</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>1480</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=p>(</span><span class=vg>tos</span><span class=w> </span><span class=il>0</span><span class=vg>x0</span><span class=p>,</span><span class=w> </span><span class=vg>ttl</span><span class=w> </span><span class=il>64</span><span class=p>,</span><span class=w> </span><span class=vg>id</span><span class=w> </span><span class=il>25541</span><span class=p>,</span><span class=w> </span><span class=vg>offset</span><span class=w> </span><span class=il>1480</span><span class=p>,</span><span class=w> </span><span class=vg>flags</span><span class=w> </span><span class=p>[</span><span class=vg>none</span><span class=p>],</span><span class=w> </span><span class=vg>proto</span><span class=w> </span><span class=vg>ICMP</span><span class=w> </span><span class=p>(</span><span class=il>1</span><span class=p>),</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>21</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=mf>192.168.2.2</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=o>:</span><span class=w> </span><span class=vg>ip</span><span class=o>-</span><span class=vg>proto</span><span class=il>-1</span><span class=w> 
</span></span></span></code></pre></div><h3 id=tcp--ip>tcp & ip<a href=#tcp--ip class=hanchor arialabel=Anchor>⚓</a></h3><h4 id=tcp-1>tcp<a href=#tcp-1 class=hanchor arialabel=Anchor>⚓</a></h4><p>tcpdump flags: S (SYN), F (FIN), P (PUSH), R (RST), U (URG), W (ECN CWR), E (ECN-Echo) or &lsquo;.&rsquo; (ACK), or &rsquo;none&rsquo; if no flags are set.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=err>$</span><span class=w> </span><span class=vg>sudo</span><span class=w> </span><span class=vg>tcpdump</span><span class=w> </span><span class=o>-</span><span class=vg>i</span><span class=w> </span><span class=vg>wlp2s0</span><span class=w> </span><span class=o>-</span><span class=vg>nt</span><span class=w> </span><span class=c1>&#39;(dst 192.168.2.2 and src 192.168.2.10) or </span>
</span></span><span class=line><span class=cl><span class=w>                              </span><span class=p>(</span><span class=vg>dst</span><span class=w> </span><span class=mf>192.168.2.10</span><span class=w> </span><span class=vg>and</span><span class=w> </span><span class=vg>src</span><span class=w> </span><span class=mf>192.168.2.2</span><span class=p>)</span><span class=c1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>S</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>334370016</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>64240</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>mss</span><span class=w> </span><span class=il>1460</span><span class=p>,</span><span class=vg>sackOK</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3258289009</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>wscale</span><span class=w> </span><span class=il>7</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>S</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>2665287474</span><span class=p>,</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>334370017</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>65160</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>mss</span><span class=w> </span><span class=il>1460</span><span class=p>,</span><span class=vg>sackOK</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>1146990448</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>3258289009</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>wscale</span><span class=w> </span><span class=il>7</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>1</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>502</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3258289143</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>1146990448</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span><span class=w>       
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>P</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>1</span><span class=o>:</span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>1</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>502</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3258293902</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>1146990448</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>8</span><span class=w>       
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>509</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>1146995364</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>3258293902</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span><span class=w>   
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>P</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>1</span><span class=o>:</span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>509</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>1146995365</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>3258293902</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>8</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>502</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3258294059</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>1146995365</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>F</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>502</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3258305051</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>1146995365</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>F</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>9</span><span class=p>,</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>10</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>509</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>1147006418</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>3258305051</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.53014</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.7</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>10</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>502</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>nop</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3258305095</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>1147006418</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-basic data-lang=basic><span class=line><span class=cl><span class=err>#</span><span class=w> </span><span class=vg>RST</span><span class=w> </span><span class=vg>when</span><span class=w> </span><span class=vg>accessing</span><span class=w> </span><span class=vg>a</span><span class=w> </span><span class=vg>non</span><span class=o>-</span><span class=vg>existent</span><span class=w> </span><span class=vg>port</span><span class=o>.</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.10.46498</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.2.54321</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>S</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>2546188616</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>64240</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=vg>options</span><span class=w> </span><span class=p>[</span><span class=vg>mss</span><span class=w> </span><span class=il>1460</span><span class=p>,</span><span class=vg>sackOK</span><span class=p>,</span><span class=vg>TS</span><span class=w> </span><span class=vg>val</span><span class=w> </span><span class=il>3265806521</span><span class=w> </span><span class=vg>ecr</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=vg>nop</span><span class=p>,</span><span class=vg>wscale</span><span class=w> </span><span class=il>7</span><span class=p>],</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span><span class=line><span class=cl><span class=vg>IP</span><span class=w> </span><span class=mf>192.168.2.2.54321</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>192.168.2.10.46498</span><span class=o>:</span><span class=w> </span><span class=vg>Flags</span><span class=w> </span><span class=p>[</span><span class=vg>R</span><span class=o>.</span><span class=p>],</span><span class=w> </span><span class=vg>seq</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>ack</span><span class=w> </span><span class=il>2546188617</span><span class=p>,</span><span class=w> </span><span class=vg>win</span><span class=w> </span><span class=il>0</span><span class=p>,</span><span class=w> </span><span class=vg>length</span><span class=w> </span><span class=il>0</span>
</span></span></code></pre></div><h2 id=thoughts>thoughts<a href=#thoughts class=hanchor arialabel=Anchor>⚓</a></h2><p>After gaining a fundamental understanding of the TCP/IP protocol model, let&rsquo;s proceed to explore sockets.</p><h2 id=refer>refer<a href=#refer class=hanchor arialabel=Anchor>⚓</a></h2><ul><li><em>High Performance Linux Service Programming - chapter 1~3</em></li><li><em>TCP/IP Illustrated Volume 1</em></li><li><em>TCP/IP Illustrated Volume 2</em></li><li><em><a href=https://stackoverflow.com/questions/34389620/telnet-unable-to-connect-to-remote-host-connection-refused>stackoverflow - enable telnet server</a></em></li></ul></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=/post/0009/><span class=button__text>gcc optimization</span>
<span class=button__icon>→</span></a></span></div></div><script src=https://utteranc.es/client.js repo=zexsphere/zexsphere.github.io issue-term=pathname theme=dark-blue crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div><div class=post-toc id=post-toc><h2 class=post-toc-title></h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#tcpip-stack-intro>tcp/ip stack intro</a><ul><li><a href=#arp>arp</a></li><li><a href=#ip>ip</a></li><li><a href=#icmp>icmp</a></li><li><a href=#tcp>tcp</a></li><li><a href=#udp>udp</a></li><li><a href=#dns>dns</a></li></ul></li><li><a href=#practice>practice</a><ul><li><a href=#arp-1>arp</a></li><li><a href=#dns-1>dns</a></li><li><a href=#icmp-1>icmp</a></li><li><a href=#tcp--ip>tcp & ip</a></li></ul></li><li><a href=#thoughts>thoughts</a></li><li><a href=#refer>refer</a></li></ul></nav></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>:: Powered by <a href=http://gohugo.io>Hugo</a> 0.115.4</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><a id=back-to-top style=display:inline-block href=javascript:void(0); onclick='window.scrollTo({top:0,behavior:"smooth"})'><span class="iconfont icon-top"></span></a>
<script src=/assets/main.js?d41d8cd98f00b204e9800998ecf8427e></script>
<script>const addCopyButtons=function(e){document.querySelectorAll("pre > code").forEach(function(t){const n=document.createElement("button");n.className="copy-code-button",n.type="button",n.innerText="Copy";const s=document.createElement("div");s.className="copy-code-button-wrap",s.appendChild(n),n.addEventListener("click",function(){e.writeText(t.innerText).then(function(){n.blur(),n.innerText="✔️",setTimeout(function(){n.innerText="Copy"},2e3)},function(){n.innerText="Error"})});const o=t.parentNode;o.insertAdjacentElement("beforebegin",s)})},loadScript=(e,t)=>{var n=document.createElement("script");n.onerror=e=>{throw new URIError("The script "+e.target.src+" didn't load correctly.")},t&&(n.onload=t),document.head.insertAdjacentElement("beforeend",n),n.src=e},loadMermaidOnNeed=()=>{document.querySelectorAll(".mermaid").length>0&&loadScript("https://cdn.jsdelivr.net/npm/mermaid@8.10.1/dist/mermaid.min.js",()=>{document.head.insertAdjacentHTML("beforeend",`<style>.mermaid svg { background-color: #dadcd8 !important; }</style>`),mermaid.initialize({startOnLoad:!1,securityLevel:"strict",logLevel:1,theme:"neutral"}),mermaid.init(),console.log("mermaid init done")})},loadPlantUMLOnNeed=()=>{let e="language-plantuml";document.querySelectorAll("[class^="+e+"]").length>0&&loadScript("https://cdn.jsdelivr.net/gh/jmnote/plantuml-encoder@1.2.4/dist/plantuml-encoder.min.js",()=>{(function(){Array.prototype.forEach.call(document.querySelectorAll("[class^="+e+"]"),function(e){let t=document.createElement("IMG");t.loading="lazy",t.src="http://www.plantuml.com/plantuml/svg/~1"+plantumlEncoder.encode(e.innerText),e.parentNode.insertBefore(t,e),e.style.display="none"})})(),console.log("PlantUML init done")})};window.addEventListener("load",function(){const t=document.links;for(let e=0,n=t.length;e<n;e++)t[e].hostname!=window.location.hostname&&!t[e].href.startsWith("javascript:")&&!t[e].href.startsWith("mailto:")&&(t[e].target="_blank");document.querySelectorAll("#TableOfContents li").length>0&&(document.querySelector("#post-toc").style.display="block"),document.querySelectorAll("#post-toc a").forEach(e=>{e.addEventListener("click",e=>{document.querySelectorAll("#post-toc a").forEach(e=>{e.classList.remove("active")}),e.target.classList.add("active")})}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let t=this.getAttribute("href").substring(1);window.history.pushState({},"","#"+t),document.getElementById(t).scrollIntoView({behavior:"smooth"})})}),navigator&&navigator.clipboard&&addCopyButtons(navigator.clipboard),loadPlantUMLOnNeed(),loadMermaidOnNeed()})</script></div></body></html>