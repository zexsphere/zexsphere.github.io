<?xml version="1.0" encoding="utf-8" standalone="yes"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-US"><title>Zex</title><id>/</id><description>Recent content on Zex</description><generator>Hugo -- gohugo.io</generator><language>en</language><updated>2023-09-20T07:51:45Z</updated><link href="/atom.xml" rel="self" type="application/rss+xml"/><entry><title>TCP/IP stack in network programming</title><id>/post/0010/</id><link href="/post/0010/" rel="alternate" type="text/html"/><updated>2023-09-20T07:51:45Z</updated><published>2023-09-20T07:51:45Z</published><description>tcp/ip stack intro +-------+ +-------+ +-------+ | ping | |telnet | | DNS | +---+---+ +---+---+ +---+---+ | | | â€¦</description><content type="html"><![CDATA[
        <h2 id="tcpip-stack-intro">tcp/ip stack intro</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">+-------+</span><span class="w">                </span><span class="o">+-------+</span><span class="w">                         </span><span class="o">+-------+</span>
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="vg">ping</span><span class="w">  </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="vg">telnet</span><span class="w"> </span><span class="o">|</span><span class="w">                         </span><span class="o">|</span><span class="w">  </span><span class="vg">DNS</span><span class="w">  </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">+---+---+</span><span class="w">                </span><span class="o">+---+---+</span><span class="w">                         </span><span class="o">+---+---+</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                        </span><span class="o">|</span><span class="w">                                 </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----------------------------------------------------------------------+</span><span class="w">  </span><span class="vg">socket</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                        </span><span class="o">|</span><span class="w">                                 </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                    </span><span class="o">+---+---+</span><span class="w">                         </span><span class="o">+---+---+</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                    </span><span class="o">|</span><span class="w">  </span><span class="vg">TCP</span><span class="w">  </span><span class="o">+-------------+-----------+</span><span class="w">  </span><span class="vg">UDP</span><span class="w">  </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                    </span><span class="o">+-------+</span><span class="w">             </span><span class="o">|</span><span class="w">           </span><span class="o">+-------+</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                                          </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----------------------------------------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                                          </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">+---+---+</span><span class="w">                                      </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w">  </span><span class="o">+--------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="o">+-------+</span><span class="w">                                      </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="o">+---+---+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="o">|</span><span class="w">  </span><span class="vg">IP</span><span class="w">   </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="o">+---+---+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                                 </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----------------------------------------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                                 </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                         </span><span class="o">+-------+</span><span class="w">               </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                         </span><span class="o">|</span><span class="w">  </span><span class="vg">ARP</span><span class="w">  </span><span class="o">+---------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                         </span><span class="o">+-------+</span><span class="w">               </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="o">+---+---+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="o">|</span><span class="w"> </span><span class="vg">Frame</span><span class="w"> </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="o">+-------+</span>
</span></span></code></pre></div><h3 id="arp">arp</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">ARP</span><span class="w">                                            </span><span class="o">&lt;</span><span class="vg">net</span><span class="o">/</span><span class="vg">if_arp</span><span class="o">.</span><span class="vg">h</span><span class="o">&gt;</span><span class="w"> </span><span class="vg">struct</span><span class="w"> </span><span class="vg">arphdr</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">+----------------------+</span><span class="w">  </span><span class="vg">ar_hdr</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">format</span><span class="w"> </span><span class="vg">of</span><span class="w">  </span><span class="vg">hardware</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">|</span><span class="w">    </span><span class="o">+-----------------|</span><span class="w">  </span><span class="vg">ar_pro</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">format</span><span class="w"> </span><span class="vg">of</span><span class="w">  </span><span class="vg">protocol</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">+------------|</span><span class="w">  </span><span class="vg">ar_hln</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="vg">of</span><span class="w">  </span><span class="vg">hardware</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">  </span><span class="o">+---------|</span><span class="w">  </span><span class="vg">ar_pln</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="vg">of</span><span class="w">  </span><span class="vg">protocol</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="o">+------+</span><span class="w">  </span><span class="vg">ar_op</span><span class="w">   </span><span class="o">/*</span><span class="w"> </span><span class="vg">ARP</span><span class="w"> </span><span class="vg">opcode</span><span class="w"> </span><span class="p">(</span><span class="vg">command</span><span class="p">)</span><span class="w">        </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">+----------------------------------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">              </span><span class="p">(</span><span class="vg">byte</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="il">2</span><span class="w">   </span><span class="o">|</span><span class="il">2</span><span class="w">   </span><span class="o">|</span><span class="il">1</span><span class="w"> </span><span class="o">|</span><span class="il">1</span><span class="w"> </span><span class="o">|</span><span class="il">2</span><span class="w">   </span><span class="o">|</span><span class="il">6</span><span class="w">           </span><span class="o">|</span><span class="il">4</span><span class="w">       </span><span class="o">|</span><span class="il">6</span><span class="w">           </span><span class="o">|</span><span class="il">4</span><span class="w">       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">+----------------------------------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                          </span><span class="o">|</span><span class="w">            </span><span class="o">|</span><span class="w">        </span><span class="o">|</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="vg">netinet</span><span class="o">/</span><span class="vg">if_ether</span><span class="o">.</span><span class="vg">h</span><span class="o">&gt;</span><span class="w"> </span><span class="vg">struct</span><span class="w"> </span><span class="vg">ether_arp</span><span class="w">     </span><span class="o">|</span><span class="w">            </span><span class="o">|</span><span class="w">        </span><span class="o">|</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="vg">arp_sha</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">sender</span><span class="w"> </span><span class="vg">hardware</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span><span class="w">  </span><span class="o">+-+</span><span class="w">            </span><span class="o">|</span><span class="w">        </span><span class="o">|</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="vg">arp_spa</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">sender</span><span class="w"> </span><span class="vg">protocol</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span><span class="w">  </span><span class="o">|--------------+</span><span class="w">        </span><span class="o">|</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="vg">arp_tha</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">target</span><span class="w"> </span><span class="vg">hardware</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span><span class="w">  </span><span class="o">|-----------------------+</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="vg">arp_tpa</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">target</span><span class="w"> </span><span class="vg">protocol</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span><span class="w">  </span><span class="o">+------------------------------------+</span>
</span></span></code></pre></div><h3 id="ip">ip</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">IP</span>
</span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="il">1</span><span class="w">                            </span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="vg">bit</span><span class="p">)</span><span class="w">  </span><span class="il">0</span><span class="w">  </span><span class="il">3</span><span class="w"> </span><span class="il">4</span><span class="w">  </span><span class="il">7</span><span class="w"> </span><span class="il">8</span><span class="w">      </span><span class="il">5</span><span class="w">            </span><span class="il">0</span><span class="w">      </span><span class="il">7</span><span class="w"> </span><span class="il">8</span><span class="w">      </span><span class="il">5</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">+----+----+--------+</span><span class="w">          </span><span class="o">+-----------------+</span><span class="w">    </span><span class="o">&lt;</span><span class="vg">netinet</span><span class="o">/</span><span class="vg">ip</span><span class="o">.</span><span class="vg">h</span><span class="o">&gt;</span><span class="w"> </span><span class="vg">struct</span><span class="w"> </span><span class="vg">ip</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="vg">V</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="vg">hl</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="vg">tos</span><span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="o">-----&gt;</span><span class="w"> </span><span class="o">|</span><span class="vg">ttl</span><span class="w">     </span><span class="o">|</span><span class="vg">p</span><span class="w">       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">+----+----+--------+</span><span class="w">  </span><span class="o">/</span><span class="w">       </span><span class="o">+-----------------+</span><span class="w">    </span><span class="vg">ip_v</span><span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="vg">version</span><span class="w">               </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">^</span><span class="w">                    </span><span class="o">/</span><span class="w">                               </span><span class="vg">ip_hl</span><span class="w">   </span><span class="o">/*</span><span class="w"> </span><span class="vg">header</span><span class="w"> </span><span class="vg">length</span><span class="w">         </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">                                </span><span class="vg">ip_tos</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">type</span><span class="w"> </span><span class="vg">of</span><span class="w"> </span><span class="vg">service</span><span class="w">       </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">+--------------+--------------------------------+</span><span class="w">    </span><span class="vg">ip_len</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">total</span><span class="w"> </span><span class="vg">length</span><span class="w">          </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="vg">len</span><span class="w"> </span><span class="o">|</span><span class="vg">id</span><span class="w">  </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="vg">sum</span><span class="w"> </span><span class="o">|</span><span class="vg">src</span><span class="w">     </span><span class="o">|</span><span class="vg">dst</span><span class="w">     </span><span class="o">|</span><span class="w">    </span><span class="vg">ip_id</span><span class="w">   </span><span class="o">/*</span><span class="w"> </span><span class="vg">identification</span><span class="w">        </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">+-------------------+---------------------------+</span><span class="w">    </span><span class="vg">ip_off</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">fragment</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="vg">field</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="vg">byte</span><span class="p">)</span><span class="w"> </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">   </span><span class="o">|</span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">4</span><span class="w">        </span><span class="il">4</span><span class="w">            </span><span class="vg">ip_ttl</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">time</span><span class="w"> </span><span class="vg">to</span><span class="w"> </span><span class="vg">live</span><span class="w">          </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="vg">v</span><span class="w">                                     </span><span class="vg">ip_p</span><span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="vg">protocol</span><span class="w">              </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">+-----------------+</span><span class="w">                   </span><span class="vg">ip_sum</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">checksum</span><span class="w">              </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">|</span><span class="vg">id</span><span class="w"> </span><span class="o">|</span><span class="vg">off</span><span class="w">          </span><span class="o">|</span><span class="w">                   </span><span class="vg">ip_src</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">source</span><span class="w"> </span><span class="vg">address</span><span class="w">        </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="o">+-----------------+</span><span class="w">                   </span><span class="vg">ip_dst</span><span class="w">  </span><span class="o">/*</span><span class="w"> </span><span class="vg">dest</span><span class="w"> </span><span class="vg">address</span><span class="w">          </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="il">0</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="il">3</span><span class="w">           </span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="w">                                      </span><span class="il">5</span>
</span></span></code></pre></div><h3 id="icmp">icmp</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">ICMP</span><span class="w">                                       </span><span class="o">&lt;</span><span class="vg">netinet</span><span class="o">/</span><span class="vg">ip_icmp</span><span class="o">.</span><span class="vg">h</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">+---------------------------------------&gt;</span><span class="w">  </span><span class="vg">type</span><span class="w">         </span><span class="o">/*</span><span class="w"> </span><span class="vg">message</span><span class="w"> </span><span class="vg">type</span><span class="w">  </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w">  </span><span class="o">+------------------------------------&gt;</span><span class="w">  </span><span class="vg">code</span><span class="w">         </span><span class="o">/*</span><span class="w"> </span><span class="vg">type</span><span class="w"> </span><span class="vg">sub</span><span class="o">-</span><span class="vg">code</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="o">+---------------------------------&gt;</span><span class="w">  </span><span class="vg">checksum</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-----------+---------------------------+</span><span class="w">  </span><span class="vg">union</span><span class="w"> </span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="il">1</span><span class="w"> </span><span class="o">|</span><span class="il">1</span><span class="w"> </span><span class="o">|</span><span class="il">2</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="p">(</span><span class="vg">variable</span><span class="p">)</span><span class="w">              </span><span class="o">|</span><span class="w">    </span><span class="vg">struct</span><span class="w"> </span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="o">+-----------+---------------------------+</span><span class="w">      </span><span class="vg">id</span>
</span></span><span class="line"><span class="cl"><span class="w">                                               </span><span class="vg">sequence</span>
</span></span><span class="line"><span class="cl"><span class="w"> </span><span class="vg">ICMP_ECHO</span><span class="w">      </span><span class="il">8</span><span class="w">  </span><span class="o">&lt;--------------------+</span><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="vg">echo</span><span class="w">     </span><span class="o">/*</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">datagram</span><span class="w">   </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w"> </span><span class="vg">ICMP_ECHOREPLY</span><span class="w"> </span><span class="il">0</span><span class="w">           </span><span class="vg">type</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="vg">gateway</span><span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="vg">gateway</span><span class="w"> </span><span class="vg">address</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="vg">struct</span><span class="w"> </span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="w">                                               </span><span class="vg">reserved</span>
</span></span><span class="line"><span class="cl"><span class="w">                                               </span><span class="vg">mtu</span>
</span></span><span class="line"><span class="cl"><span class="w">                                             </span><span class="p">}</span><span class="w"> </span><span class="vg">frag</span><span class="w">     </span><span class="o">/*</span><span class="w"> </span><span class="vg">path</span><span class="w"> </span><span class="vg">mtu</span><span class="w"> </span><span class="vg">discovery</span><span class="w"> </span><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="w">                                           </span><span class="p">}</span>
</span></span></code></pre></div><h3 id="tcp">tcp</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">TCP</span><span class="w">                           </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w">            </span><span class="o">&lt;</span><span class="vg">netinet</span><span class="o">/</span><span class="vg">tcp</span><span class="o">.</span><span class="vg">h</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">(</span><span class="vg">bit</span><span class="p">)</span><span class="w">   </span><span class="il">0</span><span class="w">  </span><span class="il">3</span><span class="w"> </span><span class="il">4</span><span class="w">  </span><span class="il">7</span><span class="w"> </span><span class="il">8</span><span class="w"> </span><span class="il">9</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">2</span><span class="w"> </span><span class="il">3</span><span class="w"> </span><span class="il">4</span><span class="w"> </span><span class="il">5</span>
</span></span><span class="line"><span class="cl"><span class="w">               </span><span class="o">+-----------+-+-+-+-+-+-+-+</span><span class="w">           </span><span class="vg">sport</span><span class="w">    </span><span class="vg">off</span><span class="w">  </span><span class="o">:</span><span class="il">4</span><span class="w">    </span><span class="vg">win</span>
</span></span><span class="line"><span class="cl"><span class="w">               </span><span class="o">|</span><span class="vg">off</span><span class="w"> </span><span class="o">|</span><span class="vg">res1</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">           </span><span class="vg">dport</span><span class="w">    </span><span class="vg">res1</span><span class="w"> </span><span class="o">:</span><span class="il">4</span><span class="w">    </span><span class="vg">sum</span>
</span></span><span class="line"><span class="cl"><span class="w">               </span><span class="o">+-----------+-+-+-+-+-+-+-+</span><span class="w">           </span><span class="vg">seq</span><span class="w">      </span><span class="vg">CWR</span><span class="w">  </span><span class="o">:</span><span class="il">1</span><span class="w">    </span><span class="vg">urp</span>
</span></span><span class="line"><span class="cl"><span class="w">                                         </span><span class="o">^</span><span class="w">           </span><span class="vg">ack</span><span class="w">      </span><span class="vg">ECE</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="w">                                         </span><span class="o">|</span><span class="w">                    </span><span class="vg">URG</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">+---------------------------+--+------------------+</span><span class="w">    </span><span class="vg">ACK</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">|</span><span class="vg">sp</span><span class="w">  </span><span class="o">|</span><span class="vg">dp</span><span class="w">  </span><span class="o">|</span><span class="vg">seq</span><span class="w">     </span><span class="o">|</span><span class="vg">ack</span><span class="w">     </span><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="o">|</span><span class="vg">win</span><span class="w"> </span><span class="o">|</span><span class="vg">sum</span><span class="w"> </span><span class="o">|</span><span class="vg">urp</span><span class="w">  </span><span class="o">|</span><span class="w">    </span><span class="vg">PSH</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">+---------------------------+--+------------------+</span><span class="w">    </span><span class="vg">RST</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="vg">byte</span><span class="p">)</span><span class="w">  </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">4</span><span class="w">        </span><span class="il">4</span><span class="w">        </span><span class="il">1</span><span class="w">  </span><span class="il">1</span><span class="w">  </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">         </span><span class="vg">SYN</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span><span class="line"><span class="cl"><span class="w">                                                              </span><span class="vg">FIN</span><span class="w">  </span><span class="o">:</span><span class="il">1</span>
</span></span></code></pre></div><h3 id="udp">udp</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="vg">UDP</span><span class="w">                               </span><span class="o">&lt;</span><span class="vg">netinet</span><span class="o">/</span><span class="vg">udp</span><span class="o">.</span><span class="vg">h</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">+------------------+</span><span class="w">       </span><span class="vg">sport</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">|</span><span class="vg">sp</span><span class="w">  </span><span class="o">|</span><span class="vg">dp</span><span class="w">  </span><span class="o">|</span><span class="vg">ulen</span><span class="o">|</span><span class="vg">sum</span><span class="o">|</span><span class="w">       </span><span class="vg">dport</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">+------------------+</span><span class="w">       </span><span class="vg">ulen</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="vg">byte</span><span class="p">)</span><span class="w">  </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">          </span><span class="vg">sum</span>
</span></span></code></pre></div><h3 id="dns">dns</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">DNS</span><span class="w">                                         </span><span class="vg">Response</span><span class="w">      </span><span class="o">+---------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                            </span><span class="vg">Opcode</span><span class="w">                  </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                            </span><span class="vg">Authoritative</span><span class="w">           </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                         </span><span class="il">6</span><span class="w">  </span><span class="vg">Truncated</span><span class="w">               </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                              </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">1</span><span class="w">  </span><span class="il">1</span><span class="w">   </span><span class="il">7</span><span class="w">  </span><span class="vg">Recursion</span><span class="w"> </span><span class="vg">desired</span><span class="w">       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">(</span><span class="vg">bit</span><span class="p">)</span><span class="w">  </span><span class="il">0</span><span class="w"> </span><span class="il">1</span><span class="w">  </span><span class="il">4</span><span class="w"> </span><span class="il">5</span><span class="w"> </span><span class="il">6</span><span class="w"> </span><span class="il">7</span><span class="w"> </span><span class="il">8</span><span class="w"> </span><span class="il">9</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="il">1</span><span class="w"> </span><span class="il">2</span><span class="w">  </span><span class="il">5</span><span class="w">      </span><span class="vg">Recursion</span><span class="w"> </span><span class="vg">available</span><span class="w">     </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">+-+----+-+-+-+-+-+-+-+----+</span><span class="w">     </span><span class="vg">Z</span><span class="w">                       </span><span class="o">|</span><span class="w">     </span><span class="vg">transaction</span><span class="w"> </span><span class="vg">id</span>
</span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="vg">Answer</span><span class="w"> </span><span class="vg">anthenticated</span><span class="w">    </span><span class="o">+---+</span><span class="w"> </span><span class="vg">flags</span>
</span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">+-+----+-+-+-+-+-+-+-+----+</span><span class="w">     </span><span class="vg">Non</span><span class="o">-</span><span class="vg">authenticated</span><span class="w"> </span><span class="vg">data</span><span class="w">  </span><span class="o">|</span><span class="w">     </span><span class="vg">quentions</span>
</span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">^</span><span class="w">                               </span><span class="vg">Reply</span><span class="w"> </span><span class="vg">code</span><span class="w">    </span><span class="o">+---------+</span><span class="w">     </span><span class="vg">answer</span><span class="w"> </span><span class="vg">RRs</span>
</span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">|</span><span class="w">                                                             </span><span class="vg">authority</span><span class="w"> </span><span class="vg">RRs</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">+---------+----+----+----+----+----+-----+</span><span class="w">                         </span><span class="vg">additional</span><span class="w"> </span><span class="vg">RRs</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="vg">byte</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">|</span><span class="w">    </span><span class="o">||</span><span class="w">                         </span><span class="vg">queries</span>
</span></span><span class="line"><span class="cl"><span class="w">       </span><span class="o">+----+----+----+----+----+----+----+-----+</span><span class="w">                         </span><span class="vg">ansers</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span><span class="w">    </span><span class="il">2</span>
</span></span></code></pre></div><h2 id="practice">practice</h2>
<p>network topology</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">+-------------------+</span><span class="w">                  </span><span class="o">+-------------------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w"> </span><span class="vg">laptop</span><span class="w">            </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="vg">pi</span><span class="w">                </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="w">      </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="w">       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w"> </span><span class="nl">a8:</span><span class="il">9</span><span class="nl">a:</span><span class="il">73</span><span class="o">:</span><span class="il">35</span><span class="o">:</span><span class="il">96</span><span class="o">:</span><span class="il">89</span><span class="w"> </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="nl">e4:</span><span class="il">5</span><span class="nl">f:</span><span class="il">36</span><span class="o">:</span><span class="il">68</span><span class="o">:</span><span class="nl">db:</span><span class="vg">bd</span><span class="w"> </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w"> </span><span class="vg">manjaro</span><span class="w">           </span><span class="o">|</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="vg">raspberry</span><span class="w">         </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+--------+----------+</span><span class="w">                  </span><span class="o">+---------+---------+</span>
</span></span><span class="line"><span class="cl"><span class="w">  </span><span class="vg">wlp2s0</span><span class="w"> </span><span class="o">|</span><span class="w">                                       </span><span class="o">|</span><span class="w">   </span><span class="vg">eth0</span>
</span></span><span class="line"><span class="cl"><span class="o">+--------+--------------------+------------------+---------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="vg">wlan0</span><span class="w">   </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="o">+----------+----------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="vg">Router</span><span class="w">              </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="mf">192.168.2.1</span><span class="w">         </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="o">|</span><span class="w"> </span><span class="il">90</span><span class="o">:</span><span class="nl">f7:f2:eb:bb:</span><span class="vg">d4</span><span class="w">   </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                   </span><span class="o">+----------+----------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                              </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                              </span><span class="o">+</span>
</span></span></code></pre></div><h3 id="arp-1">arp</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ sudo arp -d 192.168.2.2
</span></span><span class="line"><span class="cl">$ sudo tcpdump -i wlp2s0 -ent <span class="s1">&#39;(dst 192.168.2.2 and src 192.168.2.10) or 
</span></span></span><span class="line"><span class="cl"><span class="s1">                               (dst 192.168.2.10 and src 192.168.2.2)&#39;</span> -w arp.pcap 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># another window</span>
</span></span><span class="line"><span class="cl">$ telnet 192.168.2.2 <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">Trying 192.168.2.2...
</span></span><span class="line"><span class="cl">Connected to 192.168.2.2.
</span></span><span class="line"><span class="cl">Escape character is <span class="s1">&#39;^]&#39;</span>.
</span></span><span class="line"><span class="cl">hello!
</span></span><span class="line"><span class="cl">hello!
</span></span><span class="line"><span class="cl">^<span class="o">]</span>
</span></span><span class="line"><span class="cl">telnet&gt; quit
</span></span><span class="line"><span class="cl">Connection closed.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="nl">a8:</span><span class="il">9</span><span class="nl">a:</span><span class="il">73</span><span class="o">:</span><span class="il">35</span><span class="o">:</span><span class="il">96</span><span class="o">:</span><span class="il">89</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nl">ff:ff:ff:ff:ff:</span><span class="vg">ff</span><span class="p">,</span><span class="w"> </span><span class="vg">ethertype</span><span class="w"> </span><span class="vg">ARP</span><span class="w"> </span><span class="p">(</span><span class="il">0</span><span class="vg">x0806</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">42</span><span class="o">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">Request</span><span class="w"> </span><span class="vg">who</span><span class="o">-</span><span class="vg">has</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="vg">tell</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">28</span>
</span></span><span class="line"><span class="cl"><span class="nl">e4:</span><span class="il">5</span><span class="nl">f:</span><span class="il">36</span><span class="o">:</span><span class="il">68</span><span class="o">:</span><span class="nl">db:</span><span class="vg">bd</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nl">a8:</span><span class="il">9</span><span class="nl">a:</span><span class="il">73</span><span class="o">:</span><span class="il">35</span><span class="o">:</span><span class="il">96</span><span class="o">:</span><span class="il">89</span><span class="p">,</span><span class="w"> </span><span class="vg">ethertype</span><span class="w"> </span><span class="vg">ARP</span><span class="w"> </span><span class="p">(</span><span class="il">0</span><span class="vg">x0806</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">42</span><span class="o">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">Reply</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="vg">is</span><span class="o">-</span><span class="vg">at</span><span class="w"> </span><span class="nl">e4:</span><span class="il">5</span><span class="nl">f:</span><span class="il">36</span><span class="o">:</span><span class="il">68</span><span class="o">:</span><span class="nl">db:</span><span class="vg">bd</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">28</span>
</span></span></code></pre></div><h3 id="dns-1">dns</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ sudo tcpdump -i eth0 -nt -s <span class="m">500</span> port domain
</span></span><span class="line"><span class="cl">IP 192.168.2.2.54537 &gt; 192.168.2.1.53: 40868+ A? www.baidu.com. <span class="o">(</span>31<span class="o">)</span>
</span></span><span class="line"><span class="cl">IP 192.168.2.1.53 &gt; 192.168.2.2.54537: <span class="m">40868</span> 2/0/0 A 14.119.104.254, A 14.119.104.189 <span class="o">(</span>63<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># another window</span>
</span></span><span class="line"><span class="cl">$ host -t A www.baidu.com
</span></span><span class="line"><span class="cl">www.baidu.com has address 14.119.104.254
</span></span><span class="line"><span class="cl">www.baidu.com has address 14.119.104.189
</span></span></code></pre></div><h3 id="icmp-1">icmp</h3>
<p>MTU:
The maximum transmission unit (MTU) of a frame.</p>
<p>IP Fragment:
If the IP layer has data to transmit and the length of the data is larger than the maximum transmission unit (MTU) of the link layer, then the IP layer needs to perform fragmentation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="nl">MTU:</span><span class="w">   </span><span class="il">20</span><span class="w">                    </span><span class="il">8</span><span class="w">              </span><span class="vg">1472</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="il">1500</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">+---------------------+-------------+---------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="vg">IP</span><span class="w"> </span><span class="vg">hdr</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">hdr</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">data</span><span class="w">                 </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">+---------------------+-------------+---------------------------+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="vg">if</span><span class="w"> </span><span class="vg">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="il">1472</span><span class="w">  </span><span class="o">+------------+</span><span class="w">       </span><span class="o">+------------+</span><span class="w">       </span><span class="o">+------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">|</span><span class="w"> </span><span class="vg">IP</span><span class="w">    </span><span class="vg">hdr</span><span class="w">  </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="vg">IP</span><span class="w">    </span><span class="vg">hdr</span><span class="w">  </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="vg">IP</span><span class="w">    </span><span class="vg">hdr</span><span class="w">  </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="vg">for</span><span class="w"> </span><span class="nl">example:</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="vg">set</span><span class="w">  </span><span class="vg">MF</span><span class="p">)</span><span class="w">  </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="p">(</span><span class="vg">set</span><span class="w"> </span><span class="vg">offset</span><span class="p">)</span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="p">(</span><span class="vg">set</span><span class="w"> </span><span class="vg">offset</span><span class="p">)</span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">+------------+</span><span class="w">       </span><span class="o">+------------+</span><span class="w">       </span><span class="o">+------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w">  </span><span class="vg">hdr</span><span class="w">  </span><span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="w">   </span><span class="o">|</span><span class="w">            </span><span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="w">   </span><span class="o">|</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">+------------+</span><span class="w">       </span><span class="o">|</span><span class="w">            </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w">            </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w">  </span><span class="vg">data</span><span class="w"> </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w">  </span><span class="vg">data</span><span class="w"> </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="vg">ICMP</span><span class="w">  </span><span class="vg">data</span><span class="w"> </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">|</span><span class="w">   </span><span class="il">1472</span><span class="w">     </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="il">1480</span><span class="w">     </span><span class="o">|</span><span class="w">       </span><span class="o">|</span><span class="w">     </span><span class="il">1</span><span class="w">      </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">+------------+</span><span class="w">       </span><span class="o">+------------+</span><span class="w">       </span><span class="o">+------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                       </span><span class="il">1500</span><span class="w">                 </span><span class="il">1500</span><span class="w">                 </span><span class="il">21</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="err">$</span><span class="w"> </span><span class="vg">ping</span><span class="w"> </span><span class="mf">192.168.2.2</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="w"> </span><span class="vg">sudo</span><span class="w"> </span><span class="vg">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="vg">i</span><span class="w"> </span><span class="vg">wlp2s0</span><span class="w"> </span><span class="o">-</span><span class="vg">ntv</span><span class="w"> </span><span class="vg">icmp</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">13535</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="vg">DF</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">84</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.10</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="o">:</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">request</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">12</span><span class="p">,</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">1</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">64</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">11628</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="vg">none</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">84</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="o">:</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">reply</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">12</span><span class="p">,</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">1</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">64</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">13681</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="vg">DF</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">84</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.10</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="o">:</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">request</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">12</span><span class="p">,</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">2</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">64</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">11827</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="vg">none</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">84</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="o">:</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">reply</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">12</span><span class="p">,</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">2</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="w"> </span><span class="vg">ping</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="o">-</span><span class="vg">s</span><span class="w"> </span><span class="il">1473</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span><span class="w"> </span><span class="vg">sudo</span><span class="w"> </span><span class="vg">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="vg">i</span><span class="w"> </span><span class="vg">wlp2s0</span><span class="w"> </span><span class="o">-</span><span class="vg">ntv</span><span class="w"> </span><span class="vg">icmp</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">21704</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="o">+</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">1500</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.10</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="o">:</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">request</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">13</span><span class="p">,</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">1</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">1480</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">21704</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">1480</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="vg">none</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">21</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.10</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="o">:</span><span class="w"> </span><span class="vg">ip</span><span class="o">-</span><span class="vg">proto</span><span class="il">-1</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">25541</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="o">+</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">1500</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="o">:</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="vg">echo</span><span class="w"> </span><span class="vg">reply</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">13</span><span class="p">,</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">1</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">1480</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="p">(</span><span class="vg">tos</span><span class="w"> </span><span class="il">0</span><span class="vg">x0</span><span class="p">,</span><span class="w"> </span><span class="vg">ttl</span><span class="w"> </span><span class="il">64</span><span class="p">,</span><span class="w"> </span><span class="vg">id</span><span class="w"> </span><span class="il">25541</span><span class="p">,</span><span class="w"> </span><span class="vg">offset</span><span class="w"> </span><span class="il">1480</span><span class="p">,</span><span class="w"> </span><span class="vg">flags</span><span class="w"> </span><span class="p">[</span><span class="vg">none</span><span class="p">],</span><span class="w"> </span><span class="vg">proto</span><span class="w"> </span><span class="vg">ICMP</span><span class="w"> </span><span class="p">(</span><span class="il">1</span><span class="p">),</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">21</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="mf">192.168.2.2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="o">:</span><span class="w"> </span><span class="vg">ip</span><span class="o">-</span><span class="vg">proto</span><span class="il">-1</span><span class="w"> 
</span></span></span></code></pre></div><h3 id="tcp--ip">tcp &amp; ip</h3>
<h4 id="tcp-1">tcp</h4>
<p>tcpdump flags: S (SYN), F (FIN), P (PUSH), R (RST), U (URG), W (ECN CWR), E (ECN-Echo) or &lsquo;.&rsquo; (ACK), or &rsquo;none&rsquo; if no flags are set.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="err">$</span><span class="w"> </span><span class="vg">sudo</span><span class="w"> </span><span class="vg">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="vg">i</span><span class="w"> </span><span class="vg">wlp2s0</span><span class="w"> </span><span class="o">-</span><span class="vg">nt</span><span class="w"> </span><span class="c1">&#39;(dst 192.168.2.2 and src 192.168.2.10) or </span>
</span></span><span class="line"><span class="cl"><span class="w">                              </span><span class="p">(</span><span class="vg">dst</span><span class="w"> </span><span class="mf">192.168.2.10</span><span class="w"> </span><span class="vg">and</span><span class="w"> </span><span class="vg">src</span><span class="w"> </span><span class="mf">192.168.2.2</span><span class="p">)</span><span class="c1">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">S</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">334370016</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">64240</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">mss</span><span class="w"> </span><span class="il">1460</span><span class="p">,</span><span class="vg">sackOK</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3258289009</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">wscale</span><span class="w"> </span><span class="il">7</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">S</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">2665287474</span><span class="p">,</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">334370017</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">65160</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">mss</span><span class="w"> </span><span class="il">1460</span><span class="p">,</span><span class="vg">sackOK</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">1146990448</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">3258289009</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">wscale</span><span class="w"> </span><span class="il">7</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">1</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">502</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3258289143</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">1146990448</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span><span class="w">       
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">P</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">1</span><span class="o">:</span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">1</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">502</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3258293902</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">1146990448</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">8</span><span class="w">       
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">509</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">1146995364</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">3258293902</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">P</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">1</span><span class="o">:</span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">509</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">1146995365</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">3258293902</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">8</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">502</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3258294059</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">1146995365</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">F</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">502</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3258305051</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">1146995365</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">F</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">9</span><span class="p">,</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">10</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">509</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">1147006418</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">3258305051</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.53014</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.7</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">10</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">502</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">nop</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3258305095</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">1147006418</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="err">#</span><span class="w"> </span><span class="vg">RST</span><span class="w"> </span><span class="vg">when</span><span class="w"> </span><span class="vg">accessing</span><span class="w"> </span><span class="vg">a</span><span class="w"> </span><span class="vg">non</span><span class="o">-</span><span class="vg">existent</span><span class="w"> </span><span class="vg">port</span><span class="o">.</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.10.46498</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.2.54321</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">S</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">2546188616</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">64240</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="vg">options</span><span class="w"> </span><span class="p">[</span><span class="vg">mss</span><span class="w"> </span><span class="il">1460</span><span class="p">,</span><span class="vg">sackOK</span><span class="p">,</span><span class="vg">TS</span><span class="w"> </span><span class="vg">val</span><span class="w"> </span><span class="il">3265806521</span><span class="w"> </span><span class="vg">ecr</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="vg">nop</span><span class="p">,</span><span class="vg">wscale</span><span class="w"> </span><span class="il">7</span><span class="p">],</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span><span class="line"><span class="cl"><span class="vg">IP</span><span class="w"> </span><span class="mf">192.168.2.2.54321</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">192.168.2.10.46498</span><span class="o">:</span><span class="w"> </span><span class="vg">Flags</span><span class="w"> </span><span class="p">[</span><span class="vg">R</span><span class="o">.</span><span class="p">],</span><span class="w"> </span><span class="vg">seq</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">ack</span><span class="w"> </span><span class="il">2546188617</span><span class="p">,</span><span class="w"> </span><span class="vg">win</span><span class="w"> </span><span class="il">0</span><span class="p">,</span><span class="w"> </span><span class="vg">length</span><span class="w"> </span><span class="il">0</span>
</span></span></code></pre></div><h2 id="thoughts">thoughts</h2>
<p>After gaining a fundamental understanding of the TCP/IP protocol model, let&rsquo;s proceed to explore sockets.</p>
<h2 id="refer">refer</h2>
<ul>
<li><em>High Performance Linux Service Programming - chapter 1~3</em></li>
<li><em>TCP/IP Illustrated Volume 1</em></li>
<li><em>TCP/IP Illustrated Volume 2</em></li>
<li><em>








<a href="https://stackoverflow.com/questions/34389620/telnet-unable-to-connect-to-remote-host-connection-refused" >stackoverflow - enable telnet server</a></em></li>
</ul>

      ]]></content></entry><entry><title>gcc optimization</title><id>/post/0009/</id><link href="/post/0009/" rel="alternate" type="text/html"/><updated>2023-09-15T00:43:38Z</updated><published>2023-09-15T00:43:38Z</published><description>what is optimization for a program?
run faster use less memory, or consume fewer system resources. This can involve various techniques such â€¦</description><content type="html"><![CDATA[
        <p>what is optimization for a program?</p>
<ul>
<li>run faster</li>
<li>use less memory, or consume fewer system resources.</li>
</ul>
<p>This can involve various techniques such as algorithmic improvements, code restructuring, memory management, and compiler optimizations.</p>
<p>Let&rsquo;s take a look at compiler optimizations.</p>
<h2 id="-o">-O</h2>
<p>You can invoke <em>GCC with -Q &ndash;help=optimizers</em> to find out the exact set of optimizations that are enabled at each level.</p>
<ul>
<li><code>-O&lt;level&gt;</code> The default level is 0.
<ul>
<li>
<p><code>-O0</code> Reduce compilation time and make debugging produce the expected results.</p>
</li>
<li>
<p><code>-O1</code> The compiler tries to reduce code size and execution time, without performing any optimizations that take a great deal of compilation time.</p>
</li>
<li>
<p><code>-O2</code> Optimize even more. GCC performs nearly all supported optimizations that do not involve a space-speed tradeoff. As compared to -O, this option increases both compilation time and the performance of the generated code.</p>
</li>
<li>
<p><code>-O3</code> Optimize yet more.</p>
</li>
</ul>
</li>
</ul>
<p><code>-O&lt;level&gt;</code> turns on all optimizations specified by <code>-O&lt;level - 1&gt;</code> also turns on other optimization flags.</p>
<ul>
<li>
<p><code>-Ofast</code> enables all -O3 optimizations and disregard strict standards compliance.</p>
</li>
<li>
<p><code>-Og</code> Optimize debugging experience. -Og should be the optimization level of choice for the standard edit-compile-debug cycle, offering a reasonable level of optimization while maintaining fast compilation and a good debugging experience. It is a better choice than -O0 for producing debuggable code because some compiler passes that collect debug information are disabled at -O0. Like -O0, -Og completely disables a number of optimization passes so that individual options controlling them have no effect. Otherwise -Og enables all -O1 optimization flags except for those that may interfere with debugging.</p>
</li>
<li>
<p><code>-Os</code> Optimize for size. -Os enables all -O2 optimizations except those that often increase code size. It also enables -finline-functions, causes the compiler to tune for code size rather than execution speed, and performs further optimizations designed to reduce code size.</p>
</li>
<li>
<p><code>-Oz</code> Optimize aggressively for size rather than speed. This may increase the number of instructions executed if those instructions require fewer bytes to encode. -Oz behaves similarly to -Os including enabling most -O2 optimizations.</p>
</li>
</ul>
<p>If you use multiple -O options, with or without level numbers, the last such option is the one that is effective.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="w">      </span><span class="vg">Og</span><span class="w">         </span><span class="vg">Os</span><span class="o">/</span><span class="vg">Oz</span><span class="w">               </span><span class="vg">Ofast</span><span class="w">                   </span><span class="il">1</span><span class="o">.</span><span class="w"> </span><span class="vg">Og</span><span class="w">    </span><span class="vg">for</span><span class="w"> </span><span class="vg">debug</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">^</span><span class="w">          </span><span class="o">^</span><span class="w">                   </span><span class="o">^</span><span class="w">                       </span><span class="il">2</span><span class="o">.</span><span class="w"> </span><span class="vg">Os</span><span class="o">/</span><span class="vg">Oz</span><span class="w"> </span><span class="vg">for</span><span class="w"> </span><span class="vg">size</span>
</span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">|</span><span class="w">          </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w">                       </span><span class="il">3</span><span class="o">.</span><span class="w"> </span><span class="vg">Ofast</span><span class="w"> </span><span class="vg">not</span><span class="w"> </span><span class="vg">use</span>
</span></span><span class="line"><span class="cl"><span class="o">+----------+----------+----------+------&gt;</span><span class="w"> </span><span class="vg">optimize</span><span class="w"> </span><span class="vg">level</span><span class="w">   </span><span class="o">/-----------------------</span>
</span></span><span class="line"><span class="cl"><span class="vg">O0</span><span class="w">         </span><span class="vg">O1</span><span class="w">         </span><span class="vg">O2</span><span class="w">         </span><span class="vg">O3</span><span class="w">                        </span><span class="o">|</span><span class="w"> </span><span class="vg">O0</span><span class="w"> </span><span class="vg">for</span><span class="w"> </span><span class="vg">debug</span><span class="w"> </span><span class="vg">version</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;----------&gt;----------&gt;----------&gt;------&gt;</span><span class="w"> </span><span class="vg">enabling</span><span class="w"> </span><span class="vg">options</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="vg">O2</span><span class="w"> </span><span class="vg">for</span><span class="w"> </span><span class="vg">release</span><span class="w"> </span><span class="vg">version</span>
</span></span></code></pre></div><p>Thinks for 








<a href="https://meldmerge.org/" >Meld</a>, which helps me compare the list of optimization options.</p>
<p>Some commonly used options:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="o">-</span><span class="vg">fomit</span><span class="o">-</span><span class="vg">frame</span><span class="o">-</span><span class="vg">pointer</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><h2 id="-g">-g</h2>
<ul>
<li><code>-g&lt;level&gt;</code> The default level is 2.
<ul>
<li>
<p><code>-g0</code> produces no debug information at all. Thus, -g0 negates -g.</p>
</li>
<li>
<p><code>-g1</code> produces minimal information, enough for making backtraces in parts of the program that you donâ€™t plan to debug. This includes descriptions of functions and external variables, and line number tables, but no information about local variables.</p>
</li>
<li>
<p><code>-g2</code> between g1 and g3. And -g2 equals -g.</p>
</li>
<li>
<p><code>-g3</code> includes extra information, such as <strong>all the macro definitions</strong> present in the program. Some debuggers support macro expansion when you use -g3.</p>
</li>
</ul>
</li>
</ul>
<p>If you use multiple -O options, with or without level numbers, the last such option is the one that is effective.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="vg">g0</span><span class="w">         </span><span class="vg">g1</span><span class="w">         </span><span class="vg">g2</span><span class="w">         </span><span class="vg">g3</span><span class="w">                        </span><span class="o">|</span><span class="w"> </span><span class="vg">g2</span><span class="w"> </span><span class="vg">for</span><span class="w"> </span><span class="vg">debug</span><span class="w"> </span><span class="vg">version</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;----------&gt;----------&gt;----------&gt;------&gt;</span><span class="w"> </span><span class="vg">debug</span><span class="w"> </span><span class="vg">level</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="vg">g0</span><span class="w"> </span><span class="vg">for</span><span class="w"> </span><span class="vg">release</span><span class="w"> </span><span class="vg">version</span>
</span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="o">-</span><span class="vg">g</span>
</span></span></code></pre></div><p>In addition, command <em>strip</em> can remove the debugging information from executable programs. As a result, the program size is reduced.</p>
<h2 id="attributes">attributes</h2>
<p>Some common use cases include:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="vg">__attribute__</span><span class="w"> </span><span class="p">((</span><span class="vg">always_inline</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="vg">__attribute__</span><span class="w"> </span><span class="p">((</span><span class="vg">noreturn</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="vg">__attribute__</span><span class="w"> </span><span class="p">((</span><span class="vg">weak</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="vg">__attribute__</span><span class="w"> </span><span class="p">((</span><span class="vg">visibility</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;hidden&#34;</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="vg">__attribute__</span><span class="w"> </span><span class="p">((</span><span class="vg">packed</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><p>Perhaps I should write another article to elaborate on this.</p>
<h2 id="summary">summary</h2>
<p>As you can see, the mechanism of GCC is quite extensive. Although many things may not be needed in daily use, it is still beneficial to have some knowledge about them.</p>
<p>The optimization mechanism of GCC should be considered as a secondary means. Given the capabilities of the current machine, greater attention should be given to algorithmic improvements, code restructuring, and memory management.</p>
<h2 id="refer">refer</h2>
<ul>
<li><em>








<a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Optimize-Options" >gcc optimize options</a></em></li>
<li><em>








<a href="https://news.ycombinator.com/item?id=23140682" >hacknews about gcc optimize level</a></em></li>
<li><em>








<a href="https://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html#Debugging-Options" >gcc debugging options</a></em></li>
<li><em>Attributes of 








<a href="https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html" >Function</a></em> / 








<a href="https://gcc.gnu.org/onlinedocs/gcc/Variable-Attributes.html" >Variables</a> / 








<a href="https://gcc.gnu.org/onlinedocs/gcc/Type-Attributes.html" >Type</a></li>
</ul>

      ]]></content></entry><entry><title>CMake components - use GTest</title><id>/post/0008/</id><link href="/post/0008/" rel="alternate" type="text/html"/><updated>2023-09-08T04:43:38Z</updated><published>2023-09-08T04:43:38Z</published><description>å…³äºŽå•å…ƒæµ‹è¯•ï¼Œæ¯”è¾ƒå…³æ³¨çš„ç‚¹
æ˜“ç”¨ï¼Œå°†è¿‡ç¨‹ä¸“æ³¨äºŽæµ‹è¯• æ–¹ä¾¿ï¼Œå¯ä»¥æž„é€ æµ‹è¯•çš„å‰ææ¡ä»¶ï¼Œé‡å¤ä½¿ç”¨ ç›´è§‚ï¼Œç»“æžœå¯è§†åŒ–ï¼Œå¢žå¼ºåé¦ˆ å…ˆæ¥çœ‹ cmake è‡ªå¸¦çš„æµ‹è¯•é©±åŠ¨ç¨‹åº ctestï¼Œctest å½“ä¸”ä»…å½“è¿”å›žå€¼ä¸º 0 æ—¶ï¼Œæµ‹è¯•æˆåŠŸã€‚è¿™æ ·ä¸€æ¥ï¼Œctest æ¡†æž¶å¯ä»¥å®¹çº³å„ç§è¯­è¨€çš„æµ‹è¯•è„šæœ¬ï¼Œæ‰©å±•æ€§ â€¦</description><content type="html"><![CDATA[
        <p>å…³äºŽå•å…ƒæµ‹è¯•ï¼Œæ¯”è¾ƒå…³æ³¨çš„ç‚¹</p>
<ul>
<li>æ˜“ç”¨ï¼Œå°†è¿‡ç¨‹ä¸“æ³¨äºŽæµ‹è¯•</li>
<li>æ–¹ä¾¿ï¼Œå¯ä»¥æž„é€ æµ‹è¯•çš„å‰ææ¡ä»¶ï¼Œé‡å¤ä½¿ç”¨</li>
<li>ç›´è§‚ï¼Œç»“æžœå¯è§†åŒ–ï¼Œå¢žå¼ºåé¦ˆ</li>
</ul>
<p>å…ˆæ¥çœ‹ cmake è‡ªå¸¦çš„æµ‹è¯•é©±åŠ¨ç¨‹åº ctestï¼Œctest å½“ä¸”ä»…å½“è¿”å›žå€¼ä¸º 0 æ—¶ï¼Œæµ‹è¯•æˆåŠŸã€‚è¿™æ ·ä¸€æ¥ï¼Œctest æ¡†æž¶å¯ä»¥å®¹çº³å„ç§è¯­è¨€çš„æµ‹è¯•è„šæœ¬ï¼Œæ‰©å±•æ€§å¼ºã€‚ä½†ç”±äºŽä¸€ä¸ªè¿”å›žæ¡ç›®åªå¯¹åº”ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå› æ­¤æ›´é€‚åˆç”¨ä½œé›†æˆæµ‹è¯•ï¼Œç”¨åœ¨å•å…ƒæµ‹è¯•ä¸Šå±žäºŽæŠ˜ç£¨äººã€‚</p>
<p>æ•²å®šäº†é›†æˆæµ‹è¯•ï¼Œåœ¨å•å…ƒæµ‹è¯•ä¸Šå†æ¥å¯¹æ¯”å¯¹æ¯” cunit å’Œ gtestã€‚</p>
<h2 id="å•å…ƒæµ‹è¯•æ¡†æž¶">å•å…ƒæµ‹è¯•æ¡†æž¶</h2>
<p>cunit gtest çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä¸€æ ·çš„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">                       +----------------------------------------------+
</span></span><span class="line"><span class="cl">                       <span class="p">|</span> unit <span class="nb">test</span>                 +---------------+  <span class="p">|</span>
</span></span><span class="line"><span class="cl">                       <span class="p">|</span>   +---------------+  +---&gt;+    <span class="nb">test</span> <span class="m">1</span>     <span class="p">|</span>  <span class="p">|</span>
</span></span><span class="line"><span class="cl">                       <span class="p">|</span>   <span class="p">|</span>               <span class="p">|</span>  <span class="p">|</span>    +---------------+  <span class="p">|</span>
</span></span><span class="line"><span class="cl">                   +------&gt;+    Suit <span class="m">1</span>     +--+            .          <span class="p">|</span>
</span></span><span class="line"><span class="cl">                   <span class="p">|</span>   <span class="p">|</span>   <span class="p">|</span>               <span class="p">|</span>  <span class="p">|</span>    +---------------+  <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----------------  <span class="p">|</span>   <span class="p">|</span>   +---------------+  +---&gt;+    <span class="nb">test</span> n     <span class="p">|</span>  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>               <span class="p">|</span>  <span class="p">|</span>   <span class="p">|</span>          .                +---------------+  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Registry    +--+   +----------------------------------------------+
</span></span><span class="line"><span class="cl"><span class="p">|</span>               <span class="p">|</span>  <span class="p">|</span>              .                +---------------+
</span></span><span class="line"><span class="cl">+----------------  <span class="p">|</span>       +---------------+  +---&gt;+    <span class="nb">test</span> <span class="m">1</span>     <span class="p">|</span>
</span></span><span class="line"><span class="cl">                   <span class="p">|</span>       <span class="p">|</span>               <span class="p">|</span>  <span class="p">|</span>    +---------------+
</span></span><span class="line"><span class="cl">                   +------&gt;+    Suit m     +--+            .
</span></span><span class="line"><span class="cl">                           <span class="p">|</span>               <span class="p">|</span>  <span class="p">|</span>    +---------------+
</span></span><span class="line"><span class="cl">                           +---------------+  +---&gt;+    <span class="nb">test</span> n     <span class="p">|</span>
</span></span><span class="line"><span class="cl">                                                   +---------------+
</span></span></code></pre></div><p>gtest åœ¨æ˜“ç”¨æ€§ä¸Šåšå¾—æ›´å¥½ï¼ŒæŽ¥å£å°è£…çš„å¾ˆå¹²å‡€ã€‚æ”¯æŒäº‹ä»¶æœºåˆ¶ï¼Œæ–¹ä¾¿æ€§ä¹Ÿæ»¡è¶³äº†ï¼Œæœ€åŽçœ‹ä¸‹å¯è§†åŒ–æ–¹é¢ã€‚</p>
<h2 id="å¯è§†åŒ–">å¯è§†åŒ–</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># æ‰§è¡Œ gtest ç¨‹åºï¼Œå¹¶è¾“å‡ºä¸º xml</span>
</span></span><span class="line"><span class="cl">$ ./a.out --gtest_output<span class="o">=</span>xml:./result.xml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># xml è½¬ html</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å‚è€ƒ https://gitlab.uni-koblenz.de/agrt/gtest2html readmeä»‹ç»</span>
</span></span></code></pre></div><p>å¯è§†åŒ–ä¸Š cunit è‡ªå¸¦æ˜¾ç¤º xml çš„æ–¹å¼ï¼Œgtest éœ€è¦ç¬¬ä¸‰æ–¹å·¥å…·è½¬æ¢ã€‚</p>
<p>æœ‰ä¸€è¯´ä¸€ï¼Œcunit è¾“å‡ºé¡µé¢é£Žæ ¼è¿˜æ˜¯å¾ˆå¥½çœ‹çš„ã€‚</p>
<h2 id="é›†æˆåˆ°-cmake">é›†æˆåˆ° CMake</h2>
<p>cmake ç‰ˆæœ¬ï¼Œ1.13 å¼€å§‹éœ€è¦ c++14 çš„æ”¯æŒï¼Œ1.12 éœ€è¦ c++11ã€‚å¤§å¤šå®žé™…é¡¹ç›®ä¹Ÿä¸ä¼šç›²ç›®å¼•è¿› c++14 çš„ç‰¹æ€§ï¼Œå› æ­¤ï¼ŒæŒ‡å®š 1.12 ä¸€èˆ¬å¤Ÿç”¨äº†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmake" data-lang="cmake"><span class="line"><span class="cl"><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span> <span class="s">11</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD_REQUIRED</span> <span class="s">ON</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">find_package</span><span class="p">(</span><span class="s">GTest</span> <span class="s">QUIET</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">if</span><span class="p">(</span><span class="s">NOT</span> <span class="s">GTest_FOUND</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="nb">include</span><span class="p">(</span><span class="s">FetchContent</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="nb">FetchContent_Declare</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s">googletest</span>
</span></span><span class="line"><span class="cl">        <span class="s">GIT_REPOSITORY</span> <span class="s">https://github.com/google/googletest.git</span>
</span></span><span class="line"><span class="cl">        <span class="s">GIT_TAG</span> <span class="s">release-1.12.0</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>	<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>	<span class="c"># FetchContent_MakeAvailable() is not suitable for here :(
</span></span></span><span class="line"><span class="cl"><span class="c"></span>    <span class="nb">FetchContent_GetProperties</span><span class="p">(</span><span class="s">googletest</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="nb">if</span><span class="p">(</span><span class="s">NOT</span> <span class="s">googletest_POPULATED</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    	<span class="nb">FetchContent_Populate</span><span class="p">(</span><span class="s">googletest</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>        <span class="nb">add_subdirectory</span><span class="p">(</span><span class="o">${</span><span class="nv">googletest_SOURCE_DIR</span><span class="o">}</span> <span class="o">${</span><span class="nv">googletest_BINARY_DIR</span><span class="o">}</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>    <span class="nb">endif</span><span class="p">()</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">endif</span><span class="p">()</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">add_executable</span><span class="p">(</span><span class="s">exec_name</span> <span class="s">exec_name.cc</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">exec_name</span> <span class="s">gtest</span> <span class="s">gtest_main</span><span class="p">)</span><span class="err">
</span></span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>gtest ç›®å‰ä»Žæˆ‘çš„ä½¿ç”¨è§’åº¦æ¥è¯´ï¼Œåªå‰©ä¸‹å¯è§†åŒ–è¿™ä¸ªé—®é¢˜äº†ã€‚å¦‚æžœ gtest è¾“å‡ºçš„ xml æ”¯æŒ cunit é£Žæ ¼ï¼Œä¸”ä¸éœ€è¦å¤ªå¤æ‚çš„è®¾ç½®è¿›è¡Œæ ¼å¼è½¬æ¢ï¼Œå°±å¾ˆå¥½äº†ã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li>
<p><em>








<a href="https://www.cnblogs.com/coderzh/archive/2009/04/06/1430396.html" >gtest äº‹ä»¶æœºåˆ¶</a></em></p>
</li>
<li>
<p><em>








<a href="https://paul.pub/gtest-and-coverage/" >gtest å•å…ƒæµ‹è¯•ä¸Žä»£ç è¦†ç›–çŽ‡</a></em></p>
</li>
<li>
<p><em>








<a href="https://www.cnblogs.com/linux-sir/archive/2012/08/25/2654557.html" >cunit å•å…ƒæµ‹è¯•</a></em></p>
</li>
</ul>

      ]]></content></entry><entry><title>CMake components - use Doxygen</title><id>/post/0007/</id><link href="/post/0007/" rel="alternate" type="text/html"/><updated>2023-08-17T03:04:38Z</updated><published>2023-08-17T03:04:38Z</published><description>è¯¥å›¾ç‰‡ç”± Raka C.Â åœ¨ PixabayÂ ä¸Šå‘å¸ƒ
Doxygen ä½¿ç”¨æµç¨‹ 1. ç”Ÿæˆé…ç½® $ doxygen -g Doxyfile.in 2. ä¿®æ”¹é…ç½® æ ¹æ®éœ€è¦ä¿®æ”¹ Doxyfile.in é‡Œçš„é€‰é¡¹
# Project related configuration â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”± Raka C.Â åœ¨ PixabayÂ ä¸Š<a href="https://pixabay.com/zh/illustrations/dam-floodgate-stop-gates-8176005/">å‘å¸ƒ</a></p>
<h2 id="doxygen-ä½¿ç”¨æµç¨‹">Doxygen ä½¿ç”¨æµç¨‹</h2>
<h3 id="1-ç”Ÿæˆé…ç½®">1. ç”Ÿæˆé…ç½®</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ doxygen -g Doxyfile.in
</span></span></code></pre></div><h3 id="2-ä¿®æ”¹é…ç½®">2. ä¿®æ”¹é…ç½®</h3>
<p>æ ¹æ®éœ€è¦ä¿®æ”¹ Doxyfile.in é‡Œçš„é€‰é¡¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># Project related configuration options</span>
</span></span><span class="line"><span class="cl"><span class="nv">DOXYFILE_ENCODING</span>      <span class="o">=</span> UTF-8
</span></span><span class="line"><span class="cl"><span class="nv">PROJECT_NAME</span>           <span class="o">=</span> <span class="s2">&#34;My Project&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">PROJECT_NUMBER</span>         <span class="o">=</span> v0.1.0
</span></span><span class="line"><span class="cl"><span class="nv">PROJECT_BRIEF</span>          <span class="o">=</span> <span class="s2">&#34;a research project&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">PROJECT_LOGO</span>           <span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="nv">OUTPUT_DIRECTORY</span>       <span class="o">=</span> doc
</span></span><span class="line"><span class="cl"><span class="nv">ALLOW_UNICODE_NAMES</span>    <span class="o">=</span> NO
</span></span><span class="line"><span class="cl"><span class="nv">OUTPUT_LANGUAGE</span>        <span class="o">=</span> English
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">OPTIMIZE_OUTPUT_FOR_C</span>  <span class="o">=</span> YES
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Build related configuration options</span>
</span></span><span class="line"><span class="cl"><span class="nv">EXTRACT_ALL</span>            <span class="o">=</span> YES
</span></span><span class="line"><span class="cl"><span class="nv">EXTRACT_STATIC</span>         <span class="o">=</span> YES
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configuration options related to the input files</span>
</span></span><span class="line"><span class="cl"><span class="nv">INPUT</span>                  <span class="o">=</span> @PROJECT_SOURCE_DIR@
</span></span><span class="line"><span class="cl"><span class="nv">FILE_PATTERNS</span>          <span class="o">=</span> *.c *.h
</span></span><span class="line"><span class="cl"><span class="nv">RECURSIVE</span>              <span class="o">=</span> YES 
</span></span><span class="line"><span class="cl"><span class="nv">EXCLUDE</span>                <span class="o">=</span> @PROJECT_SOURCE_DIR@/etc @PROJECT_SOURCE_DIR@/build 
</span></span><span class="line"><span class="cl"><span class="nv">USE_MDFILE_AS_MAINPAGE</span> <span class="o">=</span> @PROJECT_SOURCE_DIR@/README.md
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configuration options related to the LaTeX output</span>
</span></span><span class="line"><span class="cl"><span class="nv">GENERATE_LATEX</span>         <span class="o">=</span> NO
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configuration options related to the HTML output</span>
</span></span><span class="line"><span class="cl"><span class="nv">GENERATE_TREEVIEW</span>      <span class="o">=</span> YES
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Configuration options related to diagram generator tools</span>
</span></span><span class="line"><span class="cl"><span class="nv">HAVE_DOT</span>               <span class="o">=</span> YES
</span></span><span class="line"><span class="cl"><span class="nv">UML_LOOK</span>               <span class="o">=</span> YES
</span></span><span class="line"><span class="cl"><span class="nv">CALL_GRAPH</span>             <span class="o">=</span> YES
</span></span><span class="line"><span class="cl"><span class="nv">CALLER_GRAPH</span>           <span class="o">=</span> YES
</span></span><span class="line"><span class="cl"><span class="nv">DOT_IMAGE_FORMAT</span>       <span class="o">=</span> svg
</span></span><span class="line"><span class="cl"><span class="nv">INTERACTIVE_SVG</span>        <span class="o">=</span> YES
</span></span></code></pre></div><h3 id="3-é›†æˆåˆ°-cmake">3. é›†æˆåˆ° CMake</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmake" data-lang="cmake"><span class="line"><span class="cl"><span class="c"># doxygen.cmake
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">find_package</span> <span class="p">(</span><span class="s">Doxygen</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">if</span> <span class="p">(</span><span class="s">DOXYGEN_FOUND</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>        <span class="nb">message</span><span class="p">(</span><span class="s2">&#34;-- -- Create and Install the HTML based API document&#34;</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>        <span class="nb">set</span><span class="p">(</span><span class="s">DOXYFILE_IN</span> <span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/Doxyfile.in</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>        <span class="nb">set</span><span class="p">(</span><span class="s">DOXYFILE</span>    <span class="o">${</span><span class="nv">PROJECT_BINARY_DIR</span><span class="o">}</span><span class="s">/Doxyfile</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>        <span class="nb">configure_file</span> <span class="p">(</span><span class="o">${</span><span class="nv">DOXYFILE_IN</span><span class="o">}</span> <span class="o">${</span><span class="nv">DOXYFILE</span><span class="o">}</span> <span class="s">@ONLY</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span>        <span class="c"># make doc
</span></span></span><span class="line"><span class="cl"><span class="c"></span>        <span class="nb">add_custom_target</span> <span class="p">(</span><span class="s">doc</span> <span class="c"># ALL 
</span></span></span><span class="line"><span class="cl"><span class="c"></span>                    <span class="s">COMMAND</span> <span class="o">${</span><span class="nv">DOXYGEN_EXECUTABLE</span><span class="o">}</span> <span class="o">${</span><span class="nv">DOXYFILE</span><span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="s">WORKING_DIRECTORY</span> <span class="o">${</span><span class="nv">PROJECT_BINARY_DIR</span><span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="s">COMMENT</span> <span class="s2">&#34;Generate docs using Doxygen&#34;</span> <span class="s">VERBATIM</span><span class="p">)</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">endif</span> <span class="p">()</span><span class="err">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmake" data-lang="cmake"><span class="line"><span class="cl"><span class="c"># CMakeLists.txt
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">include</span><span class="p">(</span><span class="s">doxygen.cmake</span><span class="p">)</span><span class="err">
</span></span></span></code></pre></div><h3 id="4-doxygen-æ³¨é‡Šé£Žæ ¼">4. Doxygen æ³¨é‡Šé£Žæ ¼</h3>
<p>Doxygen æ”¯æŒå¤šç§è¯„è®ºé£Žæ ¼ï¼Œå› æ­¤å¯ä»¥ä¸æ–­å°è¯•ï¼Œç›´åˆ°æ‰¾åˆ°è‡ªå·±å–œæ¬¢çš„ä¸€ç§ã€‚ï¼ˆè§å‚è€ƒä¸­çš„ CmdExampleï¼‰</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*! \brief Brief description.
</span></span></span><span class="line"><span class="cl"><span class="cm"> *         Brief description continued.
</span></span></span><span class="line"><span class="cl"><span class="cm"> *
</span></span></span><span class="line"><span class="cl"><span class="cm"> *  Detailed description starts here.
</span></span></span><span class="line"><span class="cl"><span class="cm"> *  
</span></span></span><span class="line"><span class="cl"><span class="cm"> * \return status code          \n
</span></span></span><span class="line"><span class="cl"><span class="cm"> *          0 Success           \n 
</span></span></span><span class="line"><span class="cl"><span class="cm"> *         -1 Failure
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 
</span></span></span><span class="line"><span class="cl"><span class="cm"> * \param[in]       w double the width of a rectangle.
</span></span></span><span class="line"><span class="cl"><span class="cm"> * \param[in]       h double the height of a rectangle.
</span></span></span><span class="line"><span class="cl"><span class="cm"> * \param[in, out]  area double the area of a rectangle.
</span></span></span><span class="line"><span class="cl"><span class="cm"> * ... 
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span></code></pre></div><p>æ³¨é‡Šä¸»è¦æ˜¯ä¾›å…¶ä»–ç¨‹åºå‘˜ç†è§£ï¼ˆä¸»è¦æ˜¯æœªæ¥çš„è‡ªå·±ï¼‰ï¼Œä¸æ˜¯ä¾›ç”¨æˆ·é˜…è¯»çš„ã€‚è‰¯å¥½çš„ä»£ç è§„èŒƒæ¯”èµ·å¤§é‡çš„æ³¨é‡Šæ¥è¯´æ›´åŠ å‹å–„ï¼Œè¿™ä¸€ç‚¹å¯ä»¥å¤šå‚è€ƒ nginx ç­‰ä¼˜ç§€ä»£ç çš„è§„èŒƒã€‚</p>
<p>ç»ƒä¹ æ³¨é‡Šé£Žæ ¼ä¸å¦‚å¤šé”»ç‚¼é”»ç‚¼å¦‚ä½•å†™ç”¨æˆ·æ‰‹å†Œå’Œäº§å“æ–‡æ¡£ï¼Œè¿™å¯¹ç¨‹åºå‘˜æ¥è¯´æ›´æœ‰ç›Šå¤„ã€‚</p>
<h2 id="æ•ˆæžœ">æ•ˆæžœ</h2>
<p>æ‰¾ä¸ª CMake é¡¹ç›®è¯•ä¸€ä¸‹å§ã€‚</p>
<p>






<img src="https://pic.imgdb.cn/item/64ddfb5d661c6c8e54ee0abf.png" alt=""  /></p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><em><a href="https://www.doxygen.nl/manual/doxygen_usage.html">doxygen - Usage</a></em></li>
<li><em><a href="https://www.doxygen.nl/manual/config.html">doxygen - Configuration</a></em></li>
<li><em><a href="https://www.doxygen.nl/manual/docblocks.html">doxygen - Documenting the code</a></em></li>
<li><em><a href="https://www.doxygen.nl/manual/commands.html#cmdexample">doxygen - CmdExample</a></em></li>
<li><em><a href="https://www.cnblogs.com/the-capricornus/p/4717566.html">cmake - configure_file</a></em></li>
</ul>

      ]]></content></entry><entry><title>Intro to Tun/Tap</title><id>/post/0006/</id><link href="/post/0006/" rel="alternate" type="text/html"/><updated>2023-08-10T01:54:51Z</updated><published>2023-08-10T01:54:51Z</published><description>è¯¥å›¾ç‰‡ç”± Simon OberthalerÂ åœ¨ PixabayÂ ä¸Š å‘å¸ƒ
åŽŸç† +---------------+ +---------------+ +---------------+ | application A | | application B | | â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”± Simon OberthalerÂ åœ¨ PixabayÂ ä¸Š








<a href="https://pixabay.com/zh/photos/elephants-herd-pachyderms-mammals-8171393/" >å‘å¸ƒ</a></p>
<h2 id="åŽŸç†">åŽŸç†</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-basic" data-lang="basic"><span class="line"><span class="cl"><span class="o">+---------------+</span><span class="w">         </span><span class="o">+---------------+</span><span class="w">         </span><span class="o">+---------------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w"> </span><span class="vg">application</span><span class="w"> </span><span class="vg">A</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="vg">application</span><span class="w"> </span><span class="vg">B</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="vg">application</span><span class="w"> </span><span class="vg">C</span><span class="w"> </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------^-------+</span><span class="w">         </span><span class="o">+-------+-------+</span><span class="w">         </span><span class="o">+-------+-------+</span><span class="w">       </span><span class="vg">user</span><span class="o">-</span><span class="vg">mode</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                         </span><span class="o">|</span><span class="w">                         </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-----------------------------------------------------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                         </span><span class="o">|</span><span class="w">                         </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">+-------</span><span class="vg">v</span><span class="o">-------------------------</span><span class="vg">v</span><span class="o">-------+</span><span class="w">     </span><span class="vg">kernel</span><span class="o">-</span><span class="vg">mode</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">               </span><span class="vg">layer</span><span class="w"> </span><span class="vg">socket</span><span class="w">              </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">+--------------------^--------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                                      </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">+--------------------</span><span class="vg">v</span><span class="o">--------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">|</span><span class="w">              </span><span class="vg">TCP</span><span class="o">/</span><span class="vg">IP</span><span class="w"> </span><span class="vg">stack</span><span class="w">               </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">+--------^-----------------------^--------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------</span><span class="vg">v</span><span class="o">-------+</span><span class="w">         </span><span class="o">+--------</span><span class="vg">v</span><span class="o">--------+</span><span class="w">     </span><span class="o">+--------</span><span class="vg">v</span><span class="o">--------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="vg">dev</span><span class="o">/</span><span class="vg">net</span><span class="o">/</span><span class="vg">tun</span><span class="w">  </span><span class="o">|</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="vg">Drivers</span><span class="w"> </span><span class="vg">for</span><span class="w">     </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="vg">Drivers</span><span class="w"> </span><span class="vg">for</span><span class="w">     </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="w">   </span><span class="vg">char</span><span class="w"> </span><span class="vg">drivers</span><span class="o">|</span><span class="w">         </span><span class="o">|</span><span class="w">    </span><span class="vg">virtual</span><span class="w"> </span><span class="vg">NIC</span><span class="w">  </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w">   </span><span class="vg">pysical</span><span class="w"> </span><span class="vg">NIC</span><span class="w">   </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-------^-------+</span><span class="w">         </span><span class="o">+--------^--------+</span><span class="w">     </span><span class="o">+--------^--------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">+--------</span><span class="vg">v</span><span class="o">--------+</span><span class="w">     </span><span class="o">+--------</span><span class="vg">v</span><span class="o">--------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">        </span><span class="p">(</span><span class="vg">tun</span><span class="w"> </span><span class="vg">tap</span><span class="p">)</span><span class="o">|</span><span class="w">    </span><span class="vg">virtual</span><span class="w"> </span><span class="vg">NIC</span><span class="w">  </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w">   </span><span class="vg">pysical</span><span class="w"> </span><span class="vg">NIC</span><span class="w">   </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                 </span><span class="o">+--------^--------+</span><span class="w">     </span><span class="o">+--------^--------+</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">|</span><span class="w">                          </span><span class="o">|</span><span class="w">                       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">+--------------------------+</span><span class="w">                       </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                                           </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+-----------------------------------------------------------------------------------+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                                           </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                      </span><span class="o">+--------------+</span><span class="w">     </span><span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="w">                                      </span><span class="o">|</span><span class="w">   </span><span class="vg">Internet</span><span class="w">   </span><span class="o">&lt;-----+</span>
</span></span><span class="line"><span class="cl"><span class="w">                                      </span><span class="o">+--------------+</span>
</span></span></code></pre></div><h2 id="å®žè·µ">å®žè·µ</h2>
<h3 id="code">code</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/if.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/if_tun.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;sys/ioctl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;fcntl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">tun_alloc</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">ifreq</span> <span class="n">ifr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="o">*</span><span class="n">clonedev</span> <span class="o">=</span> <span class="s">&#34;/dev/net/tun&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* æ‰“å¼€ /dev/net/tun */</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">clonedev</span><span class="p">,</span> <span class="n">O_RDWR</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">fd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ifr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ifr</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="n">ifr</span><span class="p">.</span><span class="n">ifr_flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* æœªæŒ‡å®šè®¾å¤‡åç§°æ—¶ï¼Œç”±å†…æ ¸åˆ†é…è®¾å¤‡å */</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">strncpy</span><span class="p">(</span><span class="n">ifr</span><span class="p">.</span><span class="n">ifr_name</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">IFNAMSIZ</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* é€šè¿‡ ioctl() å‘å†…æ ¸æ³¨å†Œç½‘ç»œè®¾å¤‡ï¼Œå®Œæˆåˆ›å»ºè™šæ‹ŸæŽ¥å£
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é€šè¿‡æ–‡ä»¶æè¿°ç¬¦ fd å…³è”ï¼Œä¸ŽæŽ¥å£é€šä¿¡ */</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">err</span> <span class="o">=</span> <span class="nf">ioctl</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">TUNSETIFF</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ifr</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//strcpy(dev, ifr.ifr_name); // this line leads to errors.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">fd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="n">nread</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">1500</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">((</span><span class="n">fd</span> <span class="o">=</span> <span class="nf">tun_alloc</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">IFF_TUN</span> <span class="o">|</span> <span class="n">IFF_NO_PI</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;tun alloc failed!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">nread</span> <span class="o">=</span> <span class="nf">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;read failed!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nf">close</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="cm">/* process packets here */</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* ç¨‹åºå…³é—­æ–‡ä»¶æè¿°ç¬¦ã€ç½‘ç»œè®¾å¤‡å’Œæ‰€æœ‰ç›¸åº”çš„è·¯çº¿å°†ä¼šæ¶ˆå¤± */</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="compile--run">compile &amp; run</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ gcc tun.c -o tun
</span></span><span class="line"><span class="cl">$ ./tun
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># open another window</span>
</span></span><span class="line"><span class="cl">$ ip addr add 10.0.0.1/24 dev tun0
</span></span><span class="line"><span class="cl">$ ip link <span class="nb">set</span> tun0 up
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># test packet acceptance</span>
</span></span><span class="line"><span class="cl">$ ping 10.0.0.2
</span></span><span class="line"><span class="cl">PING 10.0.0.2 <span class="o">(</span>10.0.0.2<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.0.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.024 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 10.0.0.2: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">64</span> <span class="nv">time</span><span class="o">=</span>0.035 ms
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li>
<p><em>








<a href="https://backreference.org/2010/03/26/tuntap-interface-tutorial/" >Tun/Tap interface tutorial</a></em></p>
</li>
<li>
<p><em>








<a href="https://www.kernel.org/doc/Documentation/networking/tuntap.txt" >Documentation/networking/tuntap.txt</a></em></p>
</li>
<li>
<p><em>








<a href="https://github.com/torvalds/linux/blob/v4.4/drivers/net/tun.c" >net/tun.c</a></em></p>
</li>
<li>
<p><em>








<a href="https://zhuanlan.zhihu.com/p/462501573" >äº‘åŽŸç”Ÿè™šæ‹ŸåŒ–ï¼šä¸€æ–‡è¯»æ‡‚ç½‘ç»œè™šæ‹ŸåŒ–ä¹‹ tun/tap ç½‘ç»œè®¾å¤‡</a></em></p>
</li>
</ul>

      ]]></content></entry><entry><title>Self-hosting services using the nginx ssl proxy</title><id>/post/0005/</id><link href="/post/0005/" rel="alternate" type="text/html"/><updated>2023-08-07T02:57:10Z</updated><published>2023-08-07T02:57:10Z</published><description>è¯¥å›¾ç‰‡ç”± Pete Linforth åœ¨ Pixabay ä¸Šå‘å¸ƒ
ç»“æž„å›¾ åŸºç¡€ç‚¹ å®¹å™¨å¯ä»¥åŠ å…¥åŒä¸€ä¸ªç½‘ç»œä¸­ï¼Œå¹¶ç›¸äº’é€šè¿‡å®¹å™¨åé€šä¿¡ å¯ä»¥ç”¨ expect è„šæœ¬è‡ªåŠ¨åŒ–æŽ§åˆ¶å‘½ä»¤è¡Œä¸‹ç¨‹åºä¸Žç”¨æˆ·çš„äº¤äº’ æ­¥éª¤ 1. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ openssl req -x509 -newkey â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”± Pete Linforth åœ¨ Pixabay ä¸Š<a href="https://pixabay.com/zh/illustrations/cyber-security-information-security-3400657/">å‘å¸ƒ</a></p>
<h2 id="ç»“æž„å›¾">ç»“æž„å›¾</h2>
<p>






<img src="https://pic.imgdb.cn/item/64d0e1231ddac507cc915777.png" alt=""  /></p>
<h2 id="åŸºç¡€ç‚¹">åŸºç¡€ç‚¹</h2>
<ol>
<li>å®¹å™¨å¯ä»¥åŠ å…¥åŒä¸€ä¸ªç½‘ç»œä¸­ï¼Œå¹¶ç›¸äº’é€šè¿‡å®¹å™¨åé€šä¿¡</li>
<li>å¯ä»¥ç”¨ expect è„šæœ¬è‡ªåŠ¨åŒ–æŽ§åˆ¶å‘½ä»¤è¡Œä¸‹ç¨‹åºä¸Žç”¨æˆ·çš„äº¤äº’</li>
</ol>
<h2 id="æ­¥éª¤">æ­¥éª¤</h2>
<h3 id="1-ç”Ÿæˆè‡ªç­¾åè¯ä¹¦">1. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days <span class="m">365</span>
</span></span></code></pre></div><h3 id="2-é…ç½®-nginxconf">2. é…ç½® nginx.conf</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">    server <span class="o">{</span>
</span></span><span class="line"><span class="cl">        listen       <span class="m">11443</span> ssl<span class="p">;</span>
</span></span><span class="line"><span class="cl">        server_name  localhost<span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        ssl_certificate       /usr/local/nginx/certs/cert.pem<span class="p">;</span>
</span></span><span class="line"><span class="cl">        ssl_certificate_key   /usr/local/nginx/certs/key.pem<span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        location / <span class="o">{</span>
</span></span><span class="line"><span class="cl">            proxy_set_header  Host              <span class="nv">$http_host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            proxy_set_header  X-Real-IP         <span class="nv">$remote_addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            proxy_set_header  X-Forwarded-For   <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            proxy_pass http://web:80<span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ......</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># server { # æ–°å¢ž Web æœåŠ¡</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#    ...</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># }</span>
</span></span></code></pre></div><h3 id="3-expect-è„šæœ¬">3. expect è„šæœ¬</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># pem.expect</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/expect</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> timeout <span class="m">30</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> password <span class="s2">&#34;123456&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">spawn /usr/local/nginx/sbin/nginx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">expect <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;PEM&#34;</span> <span class="o">{</span> send <span class="s2">&#34;</span><span class="nv">$password</span><span class="s2">\r&#34;</span><span class="p">;</span> exp_continue <span class="o">}</span> <span class="c1"># å¤šä¸ªä½¿ç”¨ SSL çš„æœåŠ¡å¯ä»¥é‡å¤ send å¤šæ¬¡</span>
</span></span><span class="line"><span class="cl">    eof
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="4-ç¼–è¯‘ç”Ÿæˆ-nginx-é•œåƒ">4. ç¼–è¯‘ç”Ÿæˆ nginx é•œåƒ</h3>
<p>ä¹Ÿå¯ä»¥ç›´æŽ¥ç”¨çŽ°æˆçš„ï¼Œæ‰“ç®—ç†Ÿæ‚‰ä¸‹è¿‡ç¨‹ï¼Œæœ‰ç©ºè¯»è¯»æºç </p>
<p><code>docker build -t nginx-proxy .</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> ubuntu</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /code</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># ubuntu æ›¿æ¢é•œåƒæº</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> sed -i s@/security.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> apt-get clean <span class="o">&amp;&amp;</span> apt-get update -y<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># ç¼–è¯‘ nginx çš„åº“ &amp; å·¥å…·</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> apt-get install gcc make libz-dev libpcre3-dev libssl-dev expect wget -y<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># ç¼–è¯‘ nginx</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> wget http://nginx.org/download/nginx-1.24.0.tar.gz <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> tar xf ./nginx-1.24.0.tar.gz <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ./nginx-1.24.0 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> ./configure --prefix<span class="o">=</span>/usr/local/nginx --with-http_ssl_module  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> make install<span class="err">
</span></span></span></code></pre></div><h3 id="5-compose-éƒ¨ç½²">5. compose éƒ¨ç½²</h3>
<p>åˆ›å»ºäº’è”ç½‘ç»œ <code>docker network create ngx-net</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># å†…éƒ¨ç›‘å¬ç«¯å£ 80  </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">web</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">python:3.7-alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ngx-net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tty</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-proxy:latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-proxy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ngx-net</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ngx/certs:/usr/local/nginx/certs</span><span class="w"> </span><span class="c"># å­˜æ”¾æ­¥éª¤1 pem è¯ä¹¦</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ngx/conf:/usr/local/nginx/conf  </span><span class="w"> </span><span class="c"># å­˜æ”¾æ­¥éª¤2 conf æ–‡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ngx/sbin:/usr/local/nginx/sbin  </span><span class="w"> </span><span class="c"># å­˜æ”¾æ­¥éª¤3 expect è„šæœ¬</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="m">11443</span><span class="p">:</span><span class="m">11443</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tty</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><h3 id="6-å¯åŠ¨">6. å¯åŠ¨</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ docker compose up -d
</span></span><span class="line"><span class="cl">$ docker <span class="nb">exec</span> -it nginx-proxy expect pem.expect
</span></span></code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>å®¹å™¨éš”ç¦»äº†çŽ¯å¢ƒï¼Œå¤æ‚åº¦è½¬ç§»åˆ°äº†éƒ¨ç½²å±‚é¢ä¸Šã€‚ä»¥ä¸Šåœ¨æŸ¥äº†ä¸å°‘èµ„æ–™åŽï¼ŒæˆåŠŸä½¿ç”¨ https è®¿é—®æ—¶å±…ç„¶äº§ç”Ÿäº†è°œä¸€èˆ¬çš„æˆå°±æ„Ÿï¼Œæœ‰ç‚¹ç¦»è°±äº†â€¦â€¦</p>

      ]]></content></entry><entry><title>Solve Common Memory Problems Using Dynamic Analysis Tools</title><id>/post/0004/</id><link href="/post/0004/" rel="alternate" type="text/html"/><updated>2023-08-06T07:52:05Z</updated><published>2023-08-06T07:52:05Z</published><description>è¯¥å›¾ç‰‡ç”± JÃ¼rgenÂ åœ¨ PixabayÂ ä¸Š å‘å¸ƒ
c/c++ å¯ä½¿ç”¨æ£€æµ‹å·¥å…·asan valgrindå®šä½ç¨‹åºé—®é¢˜ã€‚ä¸€èˆ¬çš„æ£€æŸ¥ï¼Œasan æ¯” valgrind æ›´å¿«ï¼Œç»“æžœæ›´ç²¾ç¡®ï¼Œç»è¿‡ time æµ‹è¯•ï¼Œasan æ¶ˆè€—æ—¶é—´æ˜¯ valgrind çš„ 1/30ã€‚ â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”± JÃ¼rgenÂ åœ¨ PixabayÂ ä¸Š








<a href="https://pixabay.com/zh/photos/ladybug-beetle-leaf-insect-bug-6364312/" >å‘å¸ƒ</a></p>
<p>c/c++ å¯ä½¿ç”¨æ£€æµ‹å·¥å…·<code>asan</code> <code>valgrind</code>å®šä½ç¨‹åºé—®é¢˜ã€‚ä¸€èˆ¬çš„æ£€æŸ¥ï¼Œasan æ¯” valgrind æ›´å¿«ï¼Œç»“æžœæ›´ç²¾ç¡®ï¼Œç»è¿‡ <code>time</code> æµ‹è¯•ï¼Œasan æ¶ˆè€—æ—¶é—´æ˜¯ valgrind çš„ 1/30ã€‚</p>
<h2 id="çŽ¯å¢ƒ">çŽ¯å¢ƒ</h2>
<ul>
<li>valgrindï¼ˆ3.21.0ï¼‰</li>
<li>gcc(13.1.1)</li>
</ul>
<h2 id="ç”¨æ³•">ç”¨æ³•</h2>
<ul>
<li>Sanitizer ç¼–è¯‘æ—¶é™„å¸¦ <code>-fsanitize=address -g</code> ç›´æŽ¥æ‰§è¡Œç¨‹åº</li>
<li>Valgrind  ç¼–è¯‘æ—¶é™„å¸¦ <code>-g</code> ä½¿ç”¨ Valgrind æ‰§è¡Œç¨‹åº <code>valgrind --tool=memcheck --leak-check=full ./a.out</code></li>
</ul>
<h2 id="è§¦å‘ç±»åž‹">è§¦å‘ç±»åž‹</h2>
<h3 id="å†…å­˜é—®é¢˜">å†…å­˜é—®é¢˜</h3>
<ul>
<li>
<p>memory leak</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nf">strcpy</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">&#34;Hello Leak!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/** leak here */</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>double free</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nf">free</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/** double free */</span>
</span></span><span class="line"><span class="cl"><span class="nf">free</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>use after free</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nf">free</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/** use after free */</span>
</span></span><span class="line"><span class="cl"><span class="nf">strcpy</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">&#34;Hello Leak!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>heap buffer overflow</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="nf">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="o">*</span> <span class="mi">12</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* heap-buffer-overflow */</span>
</span></span><span class="line"><span class="cl"><span class="nf">strcpy</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">&#34;Hello World!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;string is :%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">free</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>stack buffer overflow</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="cm">/** stack-buffer-overflow */</span>
</span></span><span class="line"><span class="cl"><span class="n">str</span><span class="p">[</span><span class="mi">101</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div></li>
<li>
<p>global buffer overflow</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">array</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* global-buffer-overflow */</span>
</span></span><span class="line"><span class="cl">    <span class="n">array</span><span class="p">[</span><span class="mi">101</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>alloc/dealloc mismatch</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">new</span> <span class="kt">char</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/** alloc-dealloc-mismatch*/</span>  
</span></span><span class="line"><span class="cl">    <span class="n">delete</span> <span class="n">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
<p>â€‹</p>
<p>sanitizer ç»™å‡ºçš„ä¿¡æ¯æ¯”è¾ƒç›´è§‚ï¼Œå¦‚ memory leak çš„æ‰§è¡Œä¿¡æ¯ï¼ˆç±»åž‹ã€è¡Œæ•°ã€å½±å“ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">Hello Leak!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=================================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">==</span><span class="nv">212706</span><span class="o">==</span>ERROR: LeakSanitizer: detected memory leaks
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Direct leak of <span class="m">100</span> byte<span class="o">(</span>s<span class="o">)</span> in <span class="m">1</span> object<span class="o">(</span>s<span class="o">)</span> allocated from:
</span></span><span class="line"><span class="cl">    <span class="c1">#0 0x7f6aa04e1359 in __interceptor_malloc /usr/src/debug/gcc/gcc/libsanitizer/asan/asan_malloc_linux.cpp:69</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#1 0x55c93274c1aa in main ***************************/leak.c:7</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#2 0x7f6aa023984f  (/usr/lib/libc.so.6+0x2384f) (BuildId: 2f005a79cd1a8e385972f5a102f16adba414d75e)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SUMMARY: AddressSanitizer: <span class="m">100</span> byte<span class="o">(</span>s<span class="o">)</span> leaked in <span class="m">1</span> allocation<span class="o">(</span>s<span class="o">)</span>.
</span></span></code></pre></div><h3 id="çº¿ç¨‹é—®é¢˜é™„å¸¦æµ‹è¯•">çº¿ç¨‹é—®é¢˜ï¼ˆé™„å¸¦æµ‹è¯•ï¼‰</h3>
<p>å¤šçº¿ç¨‹åœºæ™¯ä¸‹å¸¸è§çš„é”™è¯¯</p>
<ul>
<li>
<p>data race</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">g_var</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="nf">thread1</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">g_var</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="nf">thread2</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl">    <span class="n">g_var</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>dead lock</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">pthread_mutex_t</span> <span class="n">mutex_a</span><span class="p">,</span> <span class="n">mutex_b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">pthread_barrier_t</span> <span class="n">barrier</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="nf">lock_a</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pthread_barrier_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">barrier</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nf">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_b</span><span class="p">);</span>  <span class="cm">/* ç­‰å¾… lock_b é‡Šæ”¾*/</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_b</span><span class="p">);</span>        
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="nf">lock_b</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pthread_barrier_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">barrier</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nf">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_a</span><span class="p">);</span>  <span class="cm">/* ç­‰å¾… lock_a é‡Šæ”¾ */</span>
</span></span><span class="line"><span class="cl">        <span class="nf">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_a</span><span class="p">);</span>        
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex_b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
</ul>
<p>data race æ–¹é¢ï¼Œtsan ç›¸æ¯” valgrind ç»“æžœåŸºæœ¬ä¸€è‡´ï¼Œä½†é€Ÿåº¦å®Œèƒœã€‚</p>
<p>dead lock æ–¹é¢ï¼Œvalgrind èƒ½æ£€æµ‹å‡ºçº¿ç¨‹é€€å‡ºæœªè§£é”å¯¼è‡´çš„æ­»é”ï¼Œå¯¹ç›¸äº’æ­»é”æ²¡æœ‰åŠžæ³•ï¼Œtsan å¯¹æ­»é”å®Œå…¨æ²¡æœ‰åŠžæ³•ã€‚</p>
<h2 id="æƒ³æ³•">æƒ³æ³•</h2>
<p>æ¯”æŽ’æŸ¥æ‰‹æ®µæ›´é‡è¦çš„æ˜¯æŽ’æŸ¥æ€è·¯ã€‚çº¿ä¸Šçš„çŽ¯å¢ƒä¸æ¯”ç”Ÿäº§çŽ¯å¢ƒå·¥å…·é½å…¨ï¼Œè¿˜æœ‰ç€ç§ç§çº¦æŸï¼ˆè®¿é—®æ—¶æ®µé™åˆ¶ï¼ŒæœåŠ¡å¯åœé™åˆ¶ç­‰ï¼‰å¢žåŠ æˆæœ¬ã€‚ä¿æŒæ€è·¯æ¸…æ™°ï¼Œé€šè¿‡æœåŠ¡æ—¥å¿—ã€ç³»ç»Ÿè®°å½•ä¿¡æ¯å¯»æ‰¾å…³é”®ç‚¹ï¼Œæ›´è€ƒéªŒå¯¹ç³»ç»Ÿçš„æ•´ä½“äº†è§£ç¨‹åº¦ã€‚</p>
<p>æ¯”æŽ’æŸ¥æ€è·¯æ›´æŽ¥è¿‘é—®é¢˜æºå¤´çš„å°±æ˜¯è®¾è®¡æ€è·¯äº†â€¦â€¦</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><em>








<a href="https://github.com/google/sanitizers" >Sanitizers</a></em></li>
</ul>

      ]]></content></entry><entry><title>Work With An Efficient Environment</title><id>/post/0003/</id><link href="/post/0003/" rel="alternate" type="text/html"/><updated>2023-08-06T01:08:47Z</updated><published>2023-08-06T01:08:47Z</published><description>è¯¥å›¾ç‰‡ç”± Gauthier PousÂ åœ¨ PixabayÂ ä¸Š å‘å¸ƒ
ç»éªŒåˆ†äº« æ–‡æœ¬ç¼–è¾‘å™¨ - vim Vim æ˜¯é«˜åº¦å¯é…ç½®çš„ï¼Œç„¶è€Œå®šåˆ¶æ˜¯ä¸€ä»¶å¾ˆä¸ªæ€§åŒ–çš„äº‹æƒ…ï¼Œå› æ­¤æˆ‘è¯•å›¾é¿å…å»ºè®®ä»€ä¹ˆåº”è¯¥æ”¾è¿›ä½ çš„ vimrc é‡Œï¼Œä»€ä¹ˆä¸åº”è¯¥ã€‚ç›¸åï¼Œæœ¬ä¹¦å…³æ³¨çš„æ˜¯ Vim ç¼–è¾‘å™¨çš„æ ¸å¿ƒåŠŸèƒ½ã€‚ â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”± Gauthier PousÂ åœ¨ PixabayÂ ä¸Š 








<a href="https://pixabay.com/zh/photos/turtle-turtle-earth-land-market-5201848/" >å‘å¸ƒ</a></p>
<h2 id="ç»éªŒåˆ†äº«">ç»éªŒåˆ†äº«</h2>
<h3 id="æ–‡æœ¬ç¼–è¾‘å™¨---vim">æ–‡æœ¬ç¼–è¾‘å™¨ - vim</h3>
<blockquote>
<p>Vim æ˜¯é«˜åº¦å¯é…ç½®çš„ï¼Œç„¶è€Œå®šåˆ¶æ˜¯ä¸€ä»¶å¾ˆä¸ªæ€§åŒ–çš„äº‹æƒ…ï¼Œå› æ­¤æˆ‘è¯•å›¾é¿å…å»ºè®®ä»€ä¹ˆåº”è¯¥æ”¾è¿›ä½ çš„ vimrc é‡Œï¼Œä»€ä¹ˆä¸åº”è¯¥ã€‚ç›¸åï¼Œæœ¬ä¹¦å…³æ³¨çš„æ˜¯ Vim ç¼–è¾‘å™¨çš„æ ¸å¿ƒåŠŸèƒ½ã€‚ä¸ç®¡ä½ æ˜¯é€šè¿‡ SSH ç™»å½•è¿œç«¯æœåŠ¡å™¨å·¥ä½œï¼Œè¿˜æ˜¯åœ¨ç”¨æœ¬åœ°å®‰è£…äº†æ’ä»¶è€Œå¢žæ·»äº†é¢å¤–åŠŸèƒ½çš„ GVimï¼Œè¿™äº›åŠŸèƒ½éƒ½æ°¸è¿œåœ¨é‚£å„¿ã€‚ç²¾é€šäº† Vim çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½ å°±èŽ·å¾—äº†ä¸€ä¸ªå¯ç§»æ¤çš„ã€å¼ºå¤§çš„æ–‡æœ¬ç¼–è¾‘å·¥å…·ã€‚</p>
</blockquote>
<p>ä¹‹å‰æ±‚å¿«ï¼Œå­¦äººå°† Vim æ‰“é€ æˆ IDEï¼Œä¸Šä¸€å †æ’ä»¶ï¼Œæ”¹é”®ç›˜æ˜ å°„ï¼›åˆå­¦äººå°† NVim æ‰“é€ æˆ IDEï¼Œä¸Šä¸€å †æ’ä»¶ï¼Œæ”¹é”®ç›˜æ˜ å°„ã€‚å¸¸å¸¸æ’ä»¶ä¸€æ›´æ–°ï¼Œä¸€å †æŠ¥é”™ï¼ŒåˆåŽ»çœ‹æ–‡æ¡£ï¼Œä¿®æŠ¥é”™ã€‚æŠ˜è…¾æ¥æŠ˜è…¾åŽ»ï¼Œå”¯ç‹¬ä¸“ä¸šçŸ¥è¯†æ²¡å­¦ä¸Šå‡ åˆ†ã€‚</p>
<p>å°±æ­¤è€å®žäº†ï¼Œå†™ä»£ç è¯¥ç”¨ IDE å°±ç”¨ IDEï¼Œæ…¢æ…¢ç†è§£ Vim æ ¸å¿ƒåŠŸèƒ½æ‰æ˜¯æ­£é“ã€‚</p>
<ul>
<li>
<p>ç»ƒä¹  vimtutor (20min)</p>
</li>
<li>
<p>å®žè·µ <em>vim å®žç”¨æŠ€å·§</em></p>
</li>
<li>
<p>æ ¹æ®éœ€è¦ç¼–å†™ vimscript</p>
</li>
</ul>
<p>Slow is Smooth, and Smooth is Fast.</p>
<h3 id="äº¤äº’å¼shell---zshhttpsgithubcomzsh-userszsh">äº¤äº’å¼shell - 








<a href="https://github.com/zsh-users/zsh" >zsh</a></h3>
<p>zsh åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œæœ€åŸºç¡€çš„å‘½ä»¤è¡ŒåŽ†å²è¡¥å…¨ï¼Œè§£è„±é‡å¤å·¥ä½œã€‚</p>
<ul>
<li>








<a href="https://github.com/ohmyzsh/ohmyzsh" >é…ç½® ohmyzsh</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># å®‰è£…zsh-autosuggestions è‡ªåŠ¨è¡¥å…¨</span>
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> ~/.oh-my-zsh/plugins/
</span></span><span class="line"><span class="cl">$ git clone https://github.com/zsh-users/zsh-autosuggestions
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ vim ~/.zshrc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">plugins</span><span class="o">=(</span>
</span></span><span class="line"><span class="cl">	git                  <span class="c1"># git å‘½ä»¤ç¼©å†™</span>
</span></span><span class="line"><span class="cl">	zsh-autosuggestions  <span class="c1"># å‘½ä»¤è¡Œè¡¥å…¨</span>
</span></span><span class="line"><span class="cl">    autojump             <span class="c1"># å¿«é€Ÿè·³è½¬    </span>
</span></span><span class="line"><span class="cl">	<span class="c1"># ... https://github.com/ohmyzsh/ohmyzsh/wiki/Plugins</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä¸è¦å¿˜äº† source ï½ž/.zshrc è®©é…ç½®ç”Ÿæ•ˆ</span>
</span></span></code></pre></div><h3 id="ç»ˆç«¯å¤ç”¨---tmuxhttpsgithubcomtmuxtmux">ç»ˆç«¯å¤ç”¨ - 








<a href="https://github.com/tmux/tmux" >tmux</a></h3>
<p>å·¥ä½œä¸­ç»å¸¸è¿œç¨‹è¿žæŽ¥æœåŠ¡å™¨çš„äººï¼Œå¤§å¤šç»åŽ†è¿‡é“¾æŽ¥æ–­å¼€çš„æƒ…å†µã€‚éšç€ ssh æ–­è¿žï¼Œæ­£åœ¨è¿›è¡Œçš„ä»£ç ç¼–è¯‘ã€å®šä½bugã€ä¿®æ”¹é…ç½®ç­‰å¤šä¸ªçª—å£éƒ½æ²¡äº†ï¼Œåˆè¦è€ç€æ€§å­é‡è¿žï¼Œæ•²å‘½ä»¤é…ç½®ã€‚</p>
<p>æˆ–è€…ï¼Œä»Šå¤©éœ€è¦ç»§ç»­æ˜¨å¤©åšä¸å®Œçš„å·¥ä½œï¼Œé€šè¿‡ tmux ä¿ç•™å·¥ä½œçŽ¯å¢ƒå¯ä»¥çœæ—¶é—´ï¼Œè¿˜èƒ½å¸®åŠ©å›žå¿†èµ·ä¹‹å‰çš„æ€è·¯ã€‚</p>
<ul>
<li>








<a href="https://github.com/gpakosz/.tmux" >é…ç½®.tmux</a></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># å®‰è£…tmux</span>
</span></span><span class="line"><span class="cl">$ sudo pacman -S tmux
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŠ è½½ .tmux é…ç½®</span>
</span></span><span class="line"><span class="cl">$ <span class="nb">cd</span> 
</span></span><span class="line"><span class="cl">$ git clone https://github.com/gpakosz/.tmux.git
</span></span><span class="line"><span class="cl">$ ln -sf .tmux/.tmux.conf
</span></span><span class="line"><span class="cl">$ cp .tmux/.tmux.conf.local .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é…åˆ zsh ä½¿ç”¨</span>
</span></span><span class="line"><span class="cl">$ vim .tmux.conf
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ ä¸‹é¢ä¸¤è¡Œï¼ŒæŒ‡å®š tmux ä½¿ç”¨ zsh</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -g default-shell /bin/zsh
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -g default-command /bin/zsh
</span></span><span class="line"><span class="cl">:wq
</span></span></code></pre></div><h3 id="åžƒåœ¾å›žæ”¶---trash-cli">åžƒåœ¾å›žæ”¶ - trash-cli</h3>
<p>å•çº¯é˜²æ­¢è¯¯åˆ æ–‡ä»¶å¯¼è‡´ä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># å®‰è£…</span>
</span></span><span class="line"><span class="cl">$ sudo pacman -S trash-cli
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é…ç½®~/.zshrc</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">rm</span><span class="o">=</span><span class="s2">&#34;trash&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">alias</span> <span class="nv">rr</span><span class="o">=</span><span class="s2">&#34;trash-restore&#34;</span>
</span></span></code></pre></div><h3 id="è¿œç¨‹è¿žæŽ¥---ssh-keygen">è¿œç¨‹è¿žæŽ¥ - ssh-keygen</h3>
<p>ä¸€æ¬¡æ¬¡è¾“å…¥å¯†ç è¿žæŽ¥æœåŠ¡å™¨ä¹Ÿæ˜¯è®©äººå¤´ç–¼çš„äº‹æƒ…ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆ ecs ecs.pub</span>
</span></span><span class="line"><span class="cl">$ ssh-keygen -t rsa -f ecs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç§é’¥é…ç½®</span>
</span></span><span class="line"><span class="cl">$ vim ~/.ssh/config
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host ecs
</span></span><span class="line"><span class="cl">    HostName xx.xx.xx.xx
</span></span><span class="line"><span class="cl">    User user-name
</span></span><span class="line"><span class="cl">        IdentityFile ~/.ssh/server/ecs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host ecs2
</span></span><span class="line"><span class="cl">    HostName xx.xx.xx.xx
</span></span><span class="line"><span class="cl">    User user-name
</span></span><span class="line"><span class="cl">        IdentityFile ~/.ssh/server/ecs2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ssh-copy-id ä¼ è¾“å…¬é’¥</span>
</span></span><span class="line"><span class="cl">$ ssh-copy-id -i ecs.pub  user-name@xx.xx.xx.xx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿žæŽ¥</span>
</span></span><span class="line"><span class="cl">$ ssh ecs
</span></span></code></pre></div><h3 id="è¿œç¨‹åŒæ­¥---rsync">è¿œç¨‹åŒæ­¥ - rsync</h3>
<p>é…åˆä¸Šé¢çš„è¿œç¨‹è¿žæŽ¥ä½¿ç”¨æ•ˆæžœæ›´ä½³</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ rsync -av <span class="nb">source</span> ecs:/code/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -a           é€’å½’åŒæ­¥æ–‡ä»¶å…ƒä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -v           ç»“æžœè¾“å‡ºåˆ°ç»ˆç«¯</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -n           æ¨¡æ‹Ÿæ‰§è¡Œ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --delete     ç›®æ ‡æ˜¯å½“å‰çš„é•œåƒ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --link-desk  æŒ‡å®šåŸºå‡†ç›®å½•å¢žé‡å¤‡ä»½</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è„šæœ¬æ¥æº https://www.ruanyifeng.com/blog/2020/08/rsync.html</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ ¹æ®éœ€è¦ä¿®æ”¹è·¯å¾„ï¼Œè¿˜æ˜¯å¾ˆå®žç”¨çš„</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># A script to perform incremental backups using rsync</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -o errexit
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -o nounset
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -o pipefail
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">SOURCE_DIR</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&#34;/mnt/data/backups&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">DATETIME</span><span class="o">=</span><span class="s2">&#34;</span><span class="k">$(</span>date <span class="s1">&#39;+%Y-%m-%d_%H:%M:%S&#39;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">BACKUP_PATH</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">DATETIME</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">readonly</span> <span class="nv">LATEST_LINK</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">/latest&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BACKUP_DIR</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rsync -av --delete <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;</span><span class="si">${</span><span class="nv">SOURCE_DIR</span><span class="si">}</span><span class="s2">/&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --link-dest <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LATEST_LINK</span><span class="si">}</span><span class="s2">&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --exclude<span class="o">=</span><span class="s2">&#34;.cache&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BACKUP_PATH</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rm -rf <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LATEST_LINK</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">ln -s <span class="s2">&#34;</span><span class="si">${</span><span class="nv">BACKUP_PATH</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">LATEST_LINK</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></div><h3 id="keyboard-shortcuts">Keyboard Shortcuts</h3>
<p>è‡ªä»Žè„±ç¦»é¼ æ ‡åŽï¼Œé¼ æ ‡æ‰‹ä»¥åŠé¢ˆæ¤Žç–¼ç—›æ…¢æ…¢æ¶ˆå¤±äº†ã€‚æ—¥å¸¸å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ä¸‹é¢ä¸¤ä¸ªåº”ç”¨é‡Œï¼Œå¤šç”¨ç”¨å¿«æ·é”®å¯¹å¥åº·è¿˜æ˜¯æœ‰å¥½å¤„çš„ï¼ˆé€šè¿‡è§¦æ‘¸å±æ“ä½œæŒ‡é’ˆåŽ»&quot;å¤Ÿ&quot;æŸä¸ªç›®æ ‡ï¼Œæ¬¡æ•°å¤šäº†ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒç´¯çš„ï¼‰ã€‚</p>
<ul>
<li>








<a href="https://support.google.com/chrome/answer/157179" >chrome é”®ç›˜å¿«æ·é”®</a></li>
<li>








<a href="https://code.visualstudio.com/docs/getstarted/keybindings#_keyboard-shortcuts-reference" >vscode é”®ç›˜å¿«æ·é”®</a></li>
</ul>
<p>vscode è¿˜è´´å¿ƒåœ°ç»™å‡ºäº†æ‰“å°ç‰ˆçš„ ä¸€é¡µ








<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-linux.pdf" >pdf</a></p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><em>








<a href="https://aquaregia.gitbooks.io/tmux-productive-mouse-free-development_zh/content/" >tmux: Productive Mouse-Free Development</a></em></li>
<li><em>








<a href="https://coolshell.cn/articles/11312.html/comment-page-2#comments" >æ— æ’ä»¶ VIM ç¼–ç¨‹æŠ€å·§</a></em></li>
<li><em>Vim å®žç”¨æŠ€å·§</em></li>
<li><em>Vim8 æ–‡æœ¬å¤„ç†å®žæˆ˜</em></li>
</ul>
<h2 id="rip-bram">R.I.P Bram</h2>
<p>2023/08/03 Esc :wq</p>

      ]]></content></entry><entry><title>SVN Command Line Usage With Docker</title><id>/post/0002/</id><link href="/post/0002/" rel="alternate" type="text/html"/><updated>2023-08-05T00:22:28Z</updated><published>2023-08-05T00:22:28Z</published><description>è¯¥å›¾ç‰‡ç”± Gerd Altmann åœ¨ Pixabay ä¸Šå‘å¸ƒ
Self-Hosted SVN æœåŠ¡å±žäºŽ IO å¯†é›†åž‹ä»»åŠ¡ã€‚ç›¸æ¯”äºŽ Gitï¼Œæ›´é€‚åˆäºŽé¢‘ç¹è¿›è¡Œå¤§åž‹äºŒè¿›åˆ¶æ–‡ä»¶çš„å­˜å–ã€‚ä¸”å†…å­˜å ç”¨æžä½Žï¼Œä»Žè‡ªæ­å»ºæƒ…å†µçœ‹ï¼Œä¸€èˆ¬åœ¨ 3MB å·¦å³ï¼Œå³°å€¼ä¼ è¾“ 20MB å·¦å³ã€‚
Server â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”± Gerd Altmann åœ¨ Pixabay ä¸Š<a href="https://pixabay.com/zh/photos/a-book-library-read-literature-3480216/">å‘å¸ƒ</a></p>
<h2 id="self-hosted">Self-Hosted</h2>
<p>SVN æœåŠ¡å±žäºŽ IO å¯†é›†åž‹ä»»åŠ¡ã€‚ç›¸æ¯”äºŽ Gitï¼Œæ›´é€‚åˆäºŽé¢‘ç¹è¿›è¡Œå¤§åž‹äºŒè¿›åˆ¶æ–‡ä»¶çš„å­˜å–ã€‚ä¸”å†…å­˜å ç”¨æžä½Žï¼Œä»Žè‡ªæ­å»ºæƒ…å†µçœ‹ï¼Œä¸€èˆ¬åœ¨ 3MB å·¦å³ï¼Œå³°å€¼ä¼ è¾“ 20MB å·¦å³ã€‚</p>
<h2 id="server-with-docker">Server with docker</h2>
<ol>
<li>å®‰è£…æœåŠ¡ <code>docker compose up -d</code></li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># docker-compose.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3.3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nt">svn-server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  	</span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">garethflowers/svn-server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  	</span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">svn-server</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  	</span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;/svn:/var/opt/svn&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  	</span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;3690:3690&#39;</span><span class="w">
</span></span></span></code></pre></div><ol start="2">
<li>
<p>ç”Ÿæˆä»“åº“ <code>docker exec -it svn-server svnadmin create repo</code></p>
</li>
<li>
<p>é…ç½®ä»“åº“è´¦æˆ·æ–‡ä»¶ ä½äºŽ <code>^/repo/conf/{svnserver.conf passwd authz}</code></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># svnserver.conf</span>
</span></span><span class="line"><span class="cl">anon-access <span class="o">=</span> none     <span class="c1"># éžæ³¨å†Œç”¨æˆ·æƒé™</span>
</span></span><span class="line"><span class="cl">auth-access <span class="o">=</span> write    <span class="c1"># æ³¨å†Œç”¨æˆ·æƒé™</span>
</span></span><span class="line"><span class="cl">password-db <span class="o">=</span> passwd   <span class="c1"># å¯†ç æ–‡ä»¶è·¯å¾„</span>
</span></span><span class="line"><span class="cl">authz-db <span class="o">=</span> authz       <span class="c1"># æƒé™æ–‡ä»¶è·¯å¾„</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># passwd</span>
</span></span><span class="line"><span class="cl"><span class="nv">user</span> <span class="o">=</span> password        <span class="c1"># å¡«å†™ç”¨æˆ·åå¯†ç æ³¨å†Œ</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># authz</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>repo:/path<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">user</span> <span class="o">=</span> rw              <span class="c1"># è®¾ç½®ç”¨æˆ·åæ‹¥æœ‰çš„ä»“åº“è·¯å¾„æƒé™</span>
</span></span></code></pre></div><h2 id="client">Client</h2>
<ol>
<li>å®‰è£…å®¢æˆ·ç«¯ <code>sudo pacman -S subversion</code></li>
<li>æ‹‰å–æœåŠ¡ç«¯ä»“åº“ <code>svn checkout svn://path</code></li>
<li>å…¶ä½™å‘½ä»¤ç”¨åˆ°å†æŸ¥ <code>svn -h</code></li>
</ol>
<h2 id="usage">Usage</h2>
<blockquote>
<p>æˆ‘æ˜¯ä¸ºäº†è¿™ç‚¹é†‹ï¼Œæ‰åŒ…çš„è¿™é¡¿é¥ºå­</p>
</blockquote>
<h3 id="æ­å»ºä¹¦åº“">æ­å»ºä¹¦åº“</h3>
<p>æ‹¥æœ‰ä¸€åº§å›¾ä¹¦é¦†å¬èµ·æ¥å¾ˆé…·ï¼ŒæŒ‰ç…§ <a href="https://gist.github.com/zexsphere/604a37648b7ac04cd99a5ebbd851d699">ä¸­å›¾æ³•</a> å°†çŽ°æœ‰ä¹¦ç±åˆ†ç±»ï¼Œæ‰˜ç®¡äºŽäº‘ç«¯ SVN æœåŠ¡ä¸­ã€‚</p>
<p>






<img src="https://pic.imgdb.cn/item/64cdb6241ddac507cc70d920.png" alt=""  /></p>

      ]]></content></entry><entry><title>reading notes for *How to Read a Book* (1)</title><id>/post/0001/</id><link href="/post/0001/" rel="alternate" type="text/html"/><updated>2023-07-04T14:10:57Z</updated><published>2023-07-04T14:10:57Z</published><description>è¯¥å›¾ç‰‡ç”±MirosÅ‚aw i Joanna Bucholcåœ¨Pixabayä¸Š å‘å¸ƒ
å°†è¯»ä¹¦çš„ä¸»è¦ç›®çš„å½“ä½œæ˜¯å¢žè¿›è‡ªèº«ç†è§£èƒ½åŠ›çš„äººï¼Œè¢«ç§°ä½œâ€œé˜…è¯»çš„äººï¼ˆreadersï¼‰â€ã€‚
è„‰ç»œ ä¿¡æ¯æ—¶ä»£æµ·é‡çš„èµ„è®¯é˜»ç¢äº†ç†è§£åŠ›ï¼Œå¯¹å¢žè¿›ä¸–ç•Œçš„äº†è§£æ²¡æœ‰å¸¦æ¥å®žè´¨çš„å¸®åŠ©ã€‚æŽ¥æ”¶è€…æ¯å¤©å¾—åˆ°çš„æ˜¯ä»–äººæ‰“åŒ…å¥½çš„æ€åº¦å’Œè§‚ â€¦</description><content type="html"><![CDATA[
        <p>è¯¥å›¾ç‰‡ç”±MirosÅ‚aw i Joanna Bucholcåœ¨Pixabayä¸Š








<a href="https://pixabay.com/zh/photos/lake-sunset-friends-pier-dusk-8030021" >å‘å¸ƒ</a></p>
<hr>
<p>å°†è¯»ä¹¦çš„ä¸»è¦ç›®çš„å½“ä½œæ˜¯å¢žè¿›è‡ªèº«ç†è§£èƒ½åŠ›çš„äººï¼Œè¢«ç§°ä½œâ€œé˜…è¯»çš„äººï¼ˆreadersï¼‰â€ã€‚</p>
<h2 id="è„‰ç»œ">è„‰ç»œ</h2>
<p>ä¿¡æ¯æ—¶ä»£æµ·é‡çš„èµ„è®¯é˜»ç¢äº†ç†è§£åŠ›ï¼Œå¯¹å¢žè¿›ä¸–ç•Œçš„äº†è§£æ²¡æœ‰å¸¦æ¥å®žè´¨çš„å¸®åŠ©ã€‚æŽ¥æ”¶è€…æ¯å¤©å¾—åˆ°çš„æ˜¯ä»–äººæ‰“åŒ…å¥½çš„æ€åº¦å’Œè§‚ç‚¹ï¼Œé•¿æ­¤ä»¥å¾€ï¼Œè‡ªæˆ‘æ€è€ƒçš„é“è·¯å°†ä¸å¯é¿å…åœ°æŒç»­è’èŠœã€‚</p>
<p>é˜…è¯»è€…ï¼Œè¦äº²æ‰‹æ‹¿å›žé€æ¸è¢«å¿½è§†çš„èƒ½åŠ›ï¼Œåƒé²è¿…å…ˆç”Ÿåœ¨ <em>æ‹¿æ¥ä¸»ä¹‰</em> é‡Œè¯´çš„é‚£æ ·ï¼Œâ€œæˆ‘ä»¬è¦è¿ç”¨è„‘é«“ï¼Œæ”¾å‡ºçœ¼å…‰ï¼Œè‡ªå·±æ¥æ‹¿ï¼â€</p>
<p>è€Œé¢å¯¹ä¹¦æœ¬è¿™ä¸ªæ— å£°çš„è€å¸ˆï¼Œå°±è¦æ‡‚å¾—å¦‚ä½•è®©ä¹¦æœ¬æ•™å¯¼æˆ‘ä»¬ã€‚</p>
<h2 id="æ‘˜æŠ„">æ‘˜æŠ„</h2>
<blockquote>
<p>å¤ªå¤šçš„èµ„è®¯å°±å¦‚åŒå¤ªå°‘çš„èµ„è®¯ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸€ç§å¯¹ç†è§£åŠ›çš„é˜»ç¢ã€‚æ¢å¥è¯è¯´ï¼ŒçŽ°ä»£çš„åª’ä½“æ­£ä»¥åŽ‹å€’æ€§çš„æ³›æ»¥èµ„è®¯é˜»ç¢äº†æˆ‘ä»¬çš„ç†è§£åŠ›ã€‚</p>
</blockquote>
<p>è®¡ç®—æœºè¡Œä¸šå„ç§åº”ç”¨æœ¯è¯­ã€äº’è”ç½‘çš„é»‘è¯,ä¹Ÿæ˜¯ä¸€ç§å¯¹ç†è§£åŠ›çš„éšœç¢ã€‚ç”¨æœ¯è¯­æ‰¯ä¸ŠåŠå°æ—¶çš„äº‹æƒ…ï¼Œå¯èƒ½ç”¨å¤§ç™½è¯äº”åˆ†é’Ÿå°±èƒ½è¯´æ¸…ã€‚åœ¨å¤ªå¤šçš„ä¿¡æ¯é¢å‰æ²¡æœ‰åˆ†æžæ¶ˆåŒ–ï¼Œå°†æœ¯è¯­å½“ä½œè™Žçš®å¤§è¡£ï¼Œæˆ–è®¸æ˜¯ä¸€ç§å¯¹è‡ªèº«ç†è§£åŠ›çš„æ”¾å¼ƒã€‚</p>
<blockquote>
<p>ç”µè§†è§‚ä¼—ã€æ”¶éŸ³æœºå¬ä¼—ã€æ‚å¿—è¯»è€…æ‰€é¢å¯¹çš„æ˜¯ä¸€ç§å¤æ‚çš„ç»„æˆâ€”â€”ä»Žç‹¬åˆ›çš„åŽä¸½è¾žè—»åˆ°ç»è¿‡å®¡æ…ŽæŒ‘é€‰çš„èµ„æ–™ä¸Žç»Ÿè®¡â€”â€”ç›®çš„éƒ½åœ¨è®©äººä¸éœ€è¦é¢å¯¹å›°éš¾æˆ–åŠªåŠ›ï¼Œå¾ˆå®¹æ˜“å°±æ•´ç†å‡ºâ€œè‡ªå·±â€çš„æ€ç»ªã€‚ä½†æ˜¯è¿™äº›ç²¾ç¾ŽåŒ…è£…çš„èµ„è®¯æ•ˆçŽ‡å®žåœ¨å¤ªé«˜äº†ï¼Œè®©è§‚ä¼—ã€å¬ä¼—æˆ–è¯»è€…æ ¹æœ¬ç”¨ä¸ç€è‡ªå·±åšç»“è®ºã€‚ç›¸åçš„ï¼Œä»–ä»¬ç›´æŽ¥å°†åŒ…è£…è¿‡åŽçš„è§‚ç‚¹è£…è¿›è‡ªå·±çš„è„‘æµ·ä¸­ï¼Œå°±åƒå½•å½±æœºæ„¿æ„æŽ¥å—å½•å½±å¸¦ä¸€æ ·è‡ªç„¶ã€‚ä»–åªè¦æŒ‰ä¸€ä¸ªâ€œå€’å¸¦â€çš„é’®ï¼Œå°±èƒ½æ‰¾åˆ°ä»–æ‰€éœ€è¦çš„é€‚å½“è¨€è®ºã€‚</p>
</blockquote>
<p>è¿™æ®µè¯æƒ³èµ·äº†ã€ŠæŠ¢é’±å¤«å¦»ã€‹é‡Œé‚£ä¸ªè‘—åç‰‡æ®µã€‚</p>
<blockquote>
<p>è¿™ä¸ªè¯»è€…æ¯”å¦ä¸€ä¸ªè¯»è€…æ›´ä¸»åŠ¨ä¸€äº›ï¼Œä»–åœ¨é˜…è¯»ä¸–ç•Œé‡Œé¢çš„æŽ¢ç´¢èƒ½åŠ›å°±æ›´å¼ºä¸€äº›ï¼Œæ”¶èŽ·æ›´å¤šä¸€äº›ï¼Œå› è€Œä¹Ÿæ›´é«˜æ˜Žä¸€äº›ã€‚è¯»è€…å¯¹ä»–è‡ªå·±ï¼Œä»¥åŠè‡ªå·±é¢å‰çš„ä¹¦ç±ï¼Œè¦æ±‚çš„è¶Šå¤šï¼ŒèŽ·å¾—çš„å°±è¶Šå¤šã€‚</p>
</blockquote>
<p>è¿˜æ˜¯é²è¿…å…ˆç”Ÿçš„è¯ï¼Œâ€œæ€»ä¹‹ï¼Œæˆ‘ä»¬è¦æ‹¿æ¥ã€‚â€</p>
<blockquote>
<p>åªæœ‰ä¸€ç§æ–¹å¼æ˜¯çœŸæ­£åœ°åœ¨é˜…è¯»ã€‚æ²¡æœ‰ä»»ä½•å¤–åŠ›çš„å¸®åŠ©ï¼Œä½ å°±æ˜¯è¦è¯»è¿™æœ¬ä¹¦ã€‚ä½ ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåªå‡­ç€å†…å¿ƒçš„åŠ›é‡ï¼ŒçŽ©å‘³ç€çœ¼å‰çš„å­—å¥ï¼Œæ…¢æ…¢åœ°æå‡è‡ªå·±ï¼Œä»Žåªæœ‰æ¨¡ç³Šçš„æ¦‚å¿µåˆ°æ›´æ¸…æ¥šåœ°ç†è§£ä¸ºæ­¢ã€‚è¿™æ ·çš„ä¸€ç§æå‡ï¼Œæ˜¯åœ¨é˜…è¯»æ—¶çš„ä¸€ç§è„‘åŠ›æ´»åŠ¨ï¼Œä¹Ÿæ˜¯æ›´é«˜çš„é˜…è¯»æŠ€å·§ã€‚è¿™ç§é˜…è¯»å°±æ˜¯è®©ä¸€æœ¬ä¹¦å‘ä½ æ—¢æœ‰çš„ç†è§£åŠ›åšæŒ‘æˆ˜ã€‚</p>
</blockquote>
<p>å°†ä¹¦é‡Œçš„ä¿¡æ¯æŒ‘é‡ç‚¹æ‘˜å‡ºæ¥ï¼Œå¼„æˆæ¼‚äº®ç‚¹çš„æ€ç»´å¯¼å›¾ï¼Œæ˜¯è½»æ¾å’Œå®¹æ˜“çš„ï¼Œä¹Ÿå¸¸å¸¸ç»™äººä¸€ç§å·²æŽŒæ¡çš„å¹»è±¡ã€‚æ¯•ç«Ÿåº”è¯•æ•™è‚²çš„è®­ç»ƒä¸‹ï¼Œä¸‹æ„è¯†åŽ»æ‰¾è€ƒç‚¹ï¼Œç„¶åŽèŠ±å¤§åŠ›æ°”åŽ»èƒŒå’Œåˆ·é¢˜å·²ç»æˆäº†ä¹ æƒ¯ã€‚ä½†è¿™åœ¨æŽŒæ¡åŽŸç†ä¸Šå·²ç»èµ°ä¸Šæ­§è·¯ï¼Œæˆ‘æ— æ¯”èµžåŒçºªå½•ç‰‡ <em>Are Our Kids Tough Enough? Chinese School</em> é‡Œè‹±å›½æ•™å¸ˆçš„è§‚ç‚¹ï¼Œâ€œä¸­å¼å­¦æ ¡è‚¯å®šä¼šå¤±è´¥çš„ï¼Œè€Œä¸”æ˜¯æƒ¨è´¥ã€‚â€</p>
<blockquote>
<p>è¿™é‡Œçš„â€œå­¦ä¹ â€æŒ‡çš„æ˜¯ç†è§£æ›´å¤šçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯è®°ä½æ›´å¤šçš„èµ„è®¯ã€‚</p>
</blockquote>
<p>ä¸­å¼æ•™è‚²å¿…å°†æƒ¨è´¥ã€‚</p>
<blockquote>
<p>è’™ç”°è¯´ï¼šâ€œåˆå­¦è€…çš„æ— çŸ¥åœ¨äºŽæœªå­¦ï¼Œè€Œå­¦è€…çš„æ— çŸ¥åœ¨äºŽå­¦åŽã€‚â€ç¬¬ä¸€ç§çš„æ— çŸ¥æ˜¯è¿žå­—æ¯éƒ½æ²¡å­¦è¿‡ï¼Œå½“ç„¶æ— æ³•é˜…è¯»ã€‚ç¬¬äºŒç§çš„æ— çŸ¥å´æ˜¯è¯»é”™äº†è®¸å¤šä¹¦ã€‚è‹±å›½è¯—äººäºšåŽ†å±±å¤§Â·è’²ä¼¯ï¼ˆAlexander Popeï¼‰ç§°è¿™ç§äººæ˜¯ä¹¦å‘†å­ï¼Œæ— çŸ¥çš„é˜…è¯»è€…ã€‚æ€»æœ‰ä¸€äº›ä¹¦å‘†å­è¯»å¾—å¤ªå¹¿ï¼Œå´è¯»ä¸é€šã€‚å¸Œè…Šäººç»™è¿™ç§é›†é˜…è¯»ä¸Žæ„šè ¢äºŽä¸€èº«çš„äººä¸€ç§ç‰¹åˆ«ç§°å‘¼ï¼Œè¿™ä¹Ÿå¯è¿ç”¨åœ¨ä»»ä½•å¹´çºªã€å¥½è¯»ä¹¦å´è¯»ä¸æ‡‚çš„äººèº«ä¸Šã€‚ä»–ä»¬å°±å«â€œåŠç“¶é†‹â€ï¼ˆSophomoresï¼‰ã€‚</p>
</blockquote>
<p>â€œæœ‰äº›å¸¸è¯†çš„äººéƒ½ä¼šè®°å¾—ï¼Œçœ¼ç›çš„å›°æƒ‘æœ‰ä¸¤ç§ï¼Œä¹Ÿæ¥è‡ªä¸¤ç§èµ·å› ï¼Œä¸æ˜¯å› ä¸ºèµ°å‡ºå…‰æ˜Žï¼Œå°±æ˜¯å› ä¸ºèµ°è¿›å…‰æ˜Žæ‰€è‡´ï¼Œä¸è®ºæ˜¯äººä½“çš„çœ¼ç›æˆ–æ˜¯å¿ƒçµçš„çœ¼ç›ï¼Œéƒ½æ˜¯å¦‚æ­¤ã€‚â€
ç¬¬ä¸€é˜¶æ®µï¼šåŽŸæ¥æœ‰è¿™ä¸ªã€‚ç¬¬äºŒé˜¶æ®µï¼šåŽŸæ¥æ˜¯è¿™æ ·ã€‚è·¨è¿‡ç¬¬ä¸€é˜¶æ®µçš„äººå¾ˆå¤šï¼Œè¾¾åˆ°ç¬¬äºŒé˜¶æ®µçš„äººå¾ˆå°‘ã€‚è·¨è¿‡ç¬¬ä¸€é˜¶æ®µçš„äººè€Œæ²¡æœ‰åˆ°è¾¾ç¬¬äºŒé˜¶æ®µçš„äººå¸¸å¸¸ä¼šäº§ç”Ÿå‚²æ…¢å¿ƒè€Œåœç•™ï¼Œå›žèº«å˜²è®½é‚£äº›â€œæ— çŸ¥â€çš„äººâ€œæ²¡æœ‰è§è¿‡ä¸–é¢â€ã€‚å”‰ï¼Œæˆ‘ä»¬æ€Žä¹ˆä¼šè¢«ç½®äºŽå¦‚æ­¤æ»‘ç¨½çš„å¢ƒåœ°å•Šã€‚</p>
<blockquote>
<p>å…¶å®žï¼Œä»»ä½•å­¦ä¹ éƒ½ä¸è¯¥æ²¡æœ‰æ´»åŠ›ï¼Œå°±åƒä»»ä½•é˜…è¯»éƒ½ä¸è¯¥æ­»æ°”æ²‰æ²‰ã€‚</p>
</blockquote>
<blockquote>
<p>ä½†å¦‚æžœä½ è¿½å¯»çš„æ˜¯ä¸€ç§è§£é‡Šï¼Œä½ å°±å¿…é¡»åŽ»ç†è§£å®ƒï¼Œå¦åˆ™æ²¡æœ‰äººèƒ½å‘ä½ è§£é‡Šæ¸…æ¥šã€‚æ›´è¿›ä¸€æ­¥æ¥è¯´ï¼Œä¸€ä½æ´»ç”Ÿç”Ÿçš„è€å¸ˆå‡ºçŽ°åœ¨ä½ çœ¼å‰æ—¶ï¼Œä½ ä»Žäº†è§£ä»–æ‰€è¯´çš„è¯ï¼Œæ¥æå‡ç†è§£åŠ›ã€‚è€Œå¦‚æžœä¸€æœ¬ä¹¦å°±æ˜¯ä½ çš„è€å¸ˆçš„è¯ï¼Œä½ å°±å¾—ä¸€åˆ‡é è‡ªå·±äº†ã€‚</p>
</blockquote>
<h2 id="æƒ³æ³•">æƒ³æ³•</h2>
<p><em>chapter 1</em> è¯»ä¸‹æ¥ï¼Œè§‚ç‚¹å’Œ <em>Amusing Ourselves to Death</em> æ˜¯ä¸€è„‰ç›¸æ‰¿çš„ï¼ŒåŽè€…åœ¨ç¯‡å¹…ä¸Šæ·±åº¦å‰–æžäº†è¿™ç§çŽ°è±¡ã€‚é‚£ä¹ˆæœ¬ä¹¦æä¾›äº†ä¸€ç§è®©è‡ªèº«æ‘†è„±å…¶æƒ…å¢ƒçš„æ–¹æ³•ï¼Œåœ¨é˜…è¯»ä¸­å°è¯•åŽ»æŽŒæ¡æ›´æ·±ä¸€å±‚çš„ç†è§£ï¼Œä¸€æ¬¡åˆä¸€æ¬¡åŽ»æŽ¨è¿›ç†è§£åŠ›ã€‚</p>
<p>è‡ªæ‰“ ChatGPT å‡ºæ¥åŽï¼Œå¯¹å®ƒçš„ä¾èµ–ç¨‹åº¦è¶Šæ¥è¶Šé«˜ã€‚æœ‰æ—¶ä¹Ÿä¼šæƒ³ï¼Œæ˜¯ä¸æ˜¯ä»¥åŽåªéœ€è¦å‘å·æ–½ä»¤å°±è¡Œäº†ã€‚å› ä¸ºå¾ˆå¤šæƒ…å†µä¸‹ï¼ŒChatGPT èƒ½å¤Ÿå¾ˆå¥½çš„è¾…åŠ©å·¥ä½œï¼Œè®©äººè½»æ¾ä¸å°‘ã€‚æ¯•ç«Ÿäººä¸æ˜¯æœºå™¨ï¼Œå†—æ‚çš„å·¥ä½œæ˜¯åäººæ€§çš„ã€‚ä½†é•¿æ—¶é—´è®©å·¥å…·åŽ»ä»£æ›¿æ€ç»´ï¼Œè‡ªå·±å¾—ä¸åˆ°æˆé•¿ä¹Ÿæ˜¯ä»¶ä»¤äººæƒ‹æƒœçš„äº‹æƒ…ã€‚å› æ­¤æœ‰å¿…è¦è¿›è¡Œåˆ¤æ–­ï¼Œå¯¹è‡ªèº«æ¯«æ— æˆé•¿çš„ã€ä¸€çœ¼çœ‹é€çš„å†—æ‚å·¥ä½œï¼Œä¸¢ç»™ ChatGPT å§ï¼Œå…¶ä½™çš„å°½ç®¡å¤šè´¹è´¹å¿ƒæ€ã€‚</p>

      ]]></content></entry></feed>